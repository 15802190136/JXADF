!function(){var t=Flotr.DOM,e=Flotr._;Flotr.addPlugin("legend",{options:{show:!0,noColumns:1,labelFormatter:function(t){return t},labelBoxBorderColor:"#CCCCCC",labelBoxWidth:14,labelBoxHeight:10,labelBoxMargin:5,container:null,position:"nw",margin:5,backgroundColor:"#F0F0F0",backgroundOpacity:.85},callbacks:{"flotr:afterinit":function(){this.legend.insertLegend()},"flotr:destroy":function(){var e=this.legend.markup;e&&(this.legend.markup=null,t.remove(e))}},insertLegend:function(){if(this.options.legend.show){var o,l,r,i=this.series,a=this.plotOffset,n=this.options,s=n.legend,d=[],h=!1,c=this.ctx,b=e.filter(i,function(t){return t.label&&!t.hide}).length,g=s.position,f=s.margin,p=s.backgroundOpacity;if(b){var x=s.labelBoxWidth,u=s.labelBoxHeight,m=s.labelBoxMargin,C=a.left+f,v=a.top+f,B=0,k={size:1.1*n.fontSize,color:n.grid.color};for(o=i.length-1;o>-1;--o)i[o].label&&!i[o].hide&&(l=s.labelFormatter(i[o].label),B=Math.max(B,this._text.measureText(l,k).width));var y=Math.round(x+3*m+B),F=Math.round(b*(m+u)+m);if(p||0===p||(p=.1),n.HtmlText||!this.textEnabled||s.container){for(o=0;o<i.length;++o)if(i[o].label&&!i[o].hide){o%s.noColumns===0&&(d.push(h?"</tr><tr>":"<tr>"),h=!0);var w=i[o],A=s.labelBoxWidth,M=s.labelBoxHeight;l=s.labelFormatter(w.label),r="background-color:"+(w.bars&&w.bars.show&&w.bars.fillColor&&w.bars.fill?w.bars.fillColor:w.color)+";",d.push('<td class="flotr-legend-color-box">','<div style="border:1px solid ',s.labelBoxBorderColor,';padding:1px">','<div style="width:',A-1,"px;height:",M-1,"px;border:1px solid ",i[o].color,'">','<div style="width:',A,"px;height:",M,"px;",r,'"></div>',"</div>","</div>","</td>",'<td class="flotr-legend-label">',l,"</td>")}if(h&&d.push("</tr>"),d.length>0){var H='<table style="font-size:smaller;color:'+n.grid.color+'">'+d.join("")+"</table>";if(s.container)H=t.node(H),this.legend.markup=H,t.insert(s.container,H);else{var S={position:"absolute",zIndex:"2",border:"1px solid "+s.labelBoxBorderColor};"n"==g.charAt(0)?(S.top=f+a.top+"px",S.bottom="auto"):"c"==g.charAt(0)?(S.top=f+(this.plotHeight-F)/2+"px",S.bottom="auto"):"s"==g.charAt(0)&&(S.bottom=f+a.bottom+"px",S.top="auto"),"e"==g.charAt(1)?(S.right=f+a.right+"px",S.left="auto"):"w"==g.charAt(1)&&(S.left=f+a.left+"px",S.right="auto");var z=t.create("div");if(z.className="flotr-legend",t.setStyles(z,S),t.insert(z,H),t.insert(this.el,z),!p)return;var W=s.backgroundColor||n.grid.backgroundColor||"#ffffff";e.extend(S,t.size(z),{backgroundColor:W,zIndex:"",border:""}),S.width+="px",S.height+="px",z=t.create("div"),z.className="flotr-legend-bg",t.setStyles(z,S),t.opacity(z,p),t.insert(z," "),t.insert(this.el,z)}}}else{"s"==g.charAt(0)&&(v=a.top+this.plotHeight-(f+F)),"c"==g.charAt(0)&&(v=a.top+this.plotHeight/2-(f+F/2)),"e"==g.charAt(1)&&(C=a.left+this.plotWidth-(f+y)),r=this.processColor(s.backgroundColor,{opacity:p}),c.fillStyle=r,c.fillRect(C,v,y,F),c.strokeStyle=s.labelBoxBorderColor,c.strokeRect(Flotr.toPixel(C),Flotr.toPixel(v),y,F);var O=C+m,R=v+m;for(o=0;o<i.length;o++)i[o].label&&!i[o].hide&&(l=s.labelFormatter(i[o].label),c.fillStyle=i[o].color,c.fillRect(O,R,x-1,u-1),c.strokeStyle=s.labelBoxBorderColor,c.lineWidth=1,c.strokeRect(Math.ceil(O)-1.5,Math.ceil(R)-1.5,x+2,u+2),Flotr.drawText(c,l,O+x+m,R+u,k),R+=u+m)}}}}})}();