!function(e){function t(e){window.console&&window.console.log&&window.console.info(e)}function i(i){t("clear() : 开始清除原有的表格内容。。"),u=0,g=0;var o=i.attr("id");e("#"+o+"_fixColumnTable").remove(),e("#"+o+"_fixHeaderTable").remove(),e("#"+o+"_fixHeaderColumn").remove()}function o(t,o){i(t);var r=t.attr("id"),a=e("<table></table>"),f=r+"_fixColumnTable";a.attr("id",f),s(t,a,o);var c=e("<table></table>"),h=r+"_fixHeaderTable";c.attr("id",h),n(t,c);var x=e("<table></table>"),b=r+"_fixHeaderColumn";x.attr("id",b),d(t,c,x,o),e(window).scroll(function(){var i=e("#"+r).find("thead:first"),o=i[0].getBoundingClientRect().top,n=i[0].getBoundingClientRect().left;0>=o?(e("#"+h).css("display",""),e("#"+b).css({top:"0"})):(e("#"+h).css("display","none"),e("#"+b).css({top:p.getFixHeaderColumnSelfStyle(e("#"+r)[0].getBoundingClientRect().top,"top")})),o!=u?(e("#"+h).css("position","fixed"),e("#"+h).css("top",0),l(i,e("#"+h)),e("#"+f).css("position","absolute"),e("#"+f).css("left",0),e("#"+f).css("top",p.getFixColumnSelfStyle(i.height(),"top")),u=o):n!=g&&(e("#"+h).css("position","absolute"),e("#"+h).css("top",0-o),e("#"+f).css("position","fixed"),e("#"+f).css("left",t.position().left),e("#"+f).css("top",o+i.height()),g=n)})}function n(e,t){var i=e.find("thead"),o=r(i);t.css({display:"none","border-collapse":"collapse",padding:"0"}),e.append(t.append(o))}function r(t){var i=t.clone(!0);return i.attr("id","fixHeaderTable_header").css({"border-collapse":"collapse"}),i.removeClass("ui-resizable"),e("th",i).addClass("fixHeader"),l(t,i),i}function l(i,o){t("calcFixHeaderSize() : 调整表头样式。。。"),o.css("left",i[0].getBoundingClientRect().left),o.css("width",i.width());var n=e("th",i),r=e("th",o);e.each(n,function(t,i){e(r[t]).attr("width",i.clientWidth)})}function s(i,o,n){if(!(0>=n)){n++;var r=i.find("tbody:last").find("tr");t(r),e.each(r,function(t){var i=e("<tr></tr>");i.attr("id","fixColumnTr_"+t);var r=e(this).find("td");e.each(r,function(t){n>t&&i.append(e(this).clone(!0))}),o.append(i)}),o.css({"background-color":h.bgColor,"border-collapse":"collapse",position:"absolute"}),a(i,o),i.append(o)}}function a(t,i){i.css({top:p.getFixColumnSelfStyle(e(t.find("thead")[0]).height(),"top"),left:0});var o=e(t.find("tbody")[1]),n=o.find("tr"),r=i.find("tr");e.each(r,function(t){e(this).css("height",e(n[t]).height());var i=e(n[t]).find("td"),o=e(this).find("td");e.each(o,function(t,o){e(o).css("width",p.getFixColumnTdStyle(i[t].clientWidth,"width")),e(o).css("height",p.getFixColumnTdStyle(e(i[t]).height(),"height"))})})}function d(t,i,o,n){if(!(0>=n)){var r=i.find("th"),l=e("<tr></tr>");o.append(l.attr("id",t.attr("id")+"_fixHeaderColumnTr")),n++,e.each(r,function(i){if(n>i){var o=e(this).clone(!0);o.attr("id",t.attr("id")+"_fixHeaderColumnTh_"+i).css({"background-color":"rgb(139, 168, 203)",border:"1px solid #7C9CC3",padding:"0"}),l.append(o)}}),o.css({"background-color":h.bgColor,"border-collapse":"collapse",position:"fixed"}),f(t,i,o),t.append(o)}}function f(t,i,o){o.css({top:p.getFixHeaderColumnSelfStyle(t.find("thead")[0].getBoundingClientRect().top<=0?0:t.find("thead")[0].getBoundingClientRect().top,"top"),left:p.getFixHeaderColumnSelfStyle(t.find("thead")[0].getBoundingClientRect().left,"left")});var n=o.find("tr");n.css("height",p.getFixHeaderColumnTrStyle(e(t.find("thead")[0]).height(),"height"));var r=n.find("th"),l=i.find("th");e.each(r,function(t){e(this).css({width:p.getFixHeaderColumnTdStyle(e(l[t]).width(),"width"),height:p.getFixHeaderColumnTdStyle(e(l[t]).height(),"height")})})}var c,h,u=0,g=0;e.fn.flextable=function(i){return c=this,t("传入的表格："),t(c),h=e.extend({},e.fn.flextable.defaults,i),this.each(function(t){var i=e(this);o(i,h.column,t)})};var p={getFixColumnSelfStyle:function(t,i){return e.JxUtil.browser.isIE||e.JxUtil.browser.isFF||e.JxUtil.browser.isChrome,t},getFixColumnTdStyle:function(t,i){return e.JxUtil.browser.isIE?"top"==i||"width"==i&&(t+=1):e.JxUtil.browser.isFF||e.JxUtil.browser.isChrome,t},getFixHeaderColumnSelfStyle:function(t,i){return e.JxUtil.browser.isIE?"top"==i?t-=.5:"width"==i?t-=1:"left"==i&&(t-=.5):e.JxUtil.browser.isFF||e.JxUtil.browser.isChrome&&("top"==i||"width"==i||"left"==i||"height"==i&&(t-=1)),t},getFixHeaderColumnTrStyle:function(i,o){return e.JxUtil.browser.isIE?(t("调用getFixHeaderColumnTrStyle的IE修复方法："),"top"==o||("width"==o?i-=1:"left"==o&&(i=0))):e.JxUtil.browser.isFF||e.JxUtil.browser.isChrome&&(t("调用getFixHeaderColumnTrStyle的Chrome修复方法："),"top"==o||"width"==o&&(i+=1)),i},getFixHeaderColumnTdStyle:function(t,i){return e.JxUtil.browser.isIE?"top"==i||("width"==i?t+=1:"left"==i&&(t=0)):e.JxUtil.browser.isFF||e.JxUtil.browser.isChrome,t}};e.fn.flextable.setColumn=function(t){e.fn.flextable.defaults.column=t,c.flextable()},e.fn.flextable.refreshHeader=function(e,t){l(e,t)},e.fn.flextable.defaults={column:0,bgColor:"silver"}}(jQuery),jQuery.JxUtil={browser:{isIE:/trident/.test(navigator.userAgent.toLowerCase())||/msie/.test(navigator.userAgent.toLowerCase()),isFF:/firefox/.test(navigator.userAgent.toLowerCase()),isChrome:/chrome/.test(navigator.userAgent.toLowerCase())}};