function debug(e){window.console&&window.console.log&&window.console.info(e)}function isMobile(){if((/AppleWebKit.*Mobile/i.test(navigator.userAgent)||/MIDP|SymbianOS|NOKIA|SAMSUNG|LG|NEC|TCL|Alcatel|BIRD|DBTEL|Dopod|PHILIPS|HAIER|LENOVO|MOT-|Nokia|SonyEricsson|SIE-|Amoi|ZTE/.test(navigator.userAgent))&&window.location.href.indexOf("?mobile")<0)try{return/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?!0:!1}catch(e){}return!1}function isBootstrapRender(){return top.location.search&&top.location.search.indexOf("renderer=bootstrap")>-1}function resizeDialogWhenFrame(e){if(!JxUtil.isTopWindow()&&window.$currentDialog&&$currentDialog.dialog("isOpen"))if(e&&window.resizeRequired)window.resizeWidth&&window.resizeWidth!=window.initWidth&&$currentDialog.dialog("option","width",window.initWidth),window.resizeWidth&&window.resizeHeight!=window.initHeight&&$currentDialog.dialog("option","height",window.initHeight);else{var t=$(document),a=$(window),n=t.width(),r=t.height(),i=a.width(),o=a.height(),l=$(parent.window);window.resizeRequired=n<l.width()-100||r<l.height()-10,window.resizeRequired&&(n>i&&(window.resizeWidth=n>window.initWidth?n+30:window.initWidth,$currentDialog.dialog("option","width",window.resizeWidth)),r>o&&(window.resizeHeight=r>window.initHeight?r+60:window.initHeight,$currentDialog.dialog("option","height",window.resizeHeight)))}}function loadJs(e){if("undefined"==typeof JsAndCssList||-1==JsAndCssList.indexOf("["+e+"]")){var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src",e),"undefined"!=typeof t&&(document.getElementsByTagName("head")[0].appendChild(t),JsAndCssList=window.JsAndCssList+"["+e+"]")}}function loadCss(e){if(-1==JsAndCssList.indexOf("["+e+"]")){var t=document.createElement_x("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),"undefined"!=typeof t&&(document.getElementsByTagName_r("head")[0].appendChild(t),JsAndCssList+="["+e+"]")}}function errorHandler(e){null==e||""==e||"Error"==e?alert(getLangString("jxcommon.unknowerror")):e.indexOf("Incomplete reply from server")>=0||alert(e)}function exceptionHandler(e){alert(null==e||""==e||"Error"==e?getLangString("jxcommon.unknowerror"):e)}function msgTip(e,t){if(""!=e&&"null"!=e&&null!=e){var a=10,n=$("<div class='dialog' id='dialog-message'></div>"),r=$("<span class='ui-icon ui-icon-circle-check' style='float: left; margin: 0 7px 0 0;'></span>"),i=$("<p></p>");return i.text(e),n.append(r).append(i),n[0].timerMax=a||3,n.dialog({resizable:!1,modal:!0,show:{effect:"fade",duration:300},open:function(){var e=this,t=$(this),a=t.parent().find(".ui-button-text").text(getLangString("jxcommon.confirm")+"("+e.timerMax+")");--e.timerMax,e.timer=window.setInterval(function(){a.text(getLangString("jxcommon.confirm")+"("+e.timerMax+")"),e.timerMax--<=0&&(t.dialog("close"),window.clearInterval(e.timer))},1e3)},title:t||getLangString("jxcommon.tip"),buttons:[{text:getLangString("jxcommon.confirm"),click:function(){$(this).dialog("close");window.clearInterval(this.timer)}}],close:function(){n.remove(),window.clearInterval(this.timer)}})}}function getUrlParam(e){var t=location.search.match(new RegExp("[?&]"+e+"=([^&]+)","i"));return null==t||t.length<1?"":t[1]}function getUrlParamValue(e,t){if(null==e||null==t)return"";var a=e.match(new RegExp("[?&]"+t+"=([^&]+)","i"));return null==a||a.length<1?"":a[1]}function getUrlParamNameValue(e,t){if(null==e||null==t)return"";var a=e.match(new RegExp("[?&]"+t+"=([^&]+)","i"));if(null==a||a.length<1)return"";var n=a[0];return n.length>1&&("?"==n.charAt(0)||"&"==n.charAt(0))&&(n=n.substring(1)),n}function getContextPath(){var e=document.location.pathname,t=e.substr(1).indexOf("/"),a=e.substr(0,t+1);return a}function doClick(e){var t=document.getElementById(e);if(null==t&&(t=window.parent.document.getElementById(e)),null!=t)if(document.createEvent){var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!1),t.dispatchEvent(a)}else document.createEventObject&&t.fireEvent("onclick")}function showDate(e,t){var a=$(e).attr("tid"),n=$("#"+a);showDatePicker(e,t,"datepicker",{showButtonPanel:!0,currentText:getLangString("jxcommon.datepicker.today"),closeText:getLangString("jxcommon.datepicker.close"),dateFormat:"yy-mm-dd",onClose:function(e){""!=e&&(n.attr("changed","1"),"QUERYIMMEDIATELY"!=n.attr("inputmode")&&n.blur()),resizeDialogWhenFrame(!0)},beforeShow:function(e){setTimeout(function(){var t=n.datepicker("widget").find(".ui-datepicker-buttonpane");t.html(""),$("<span/>",{"class":"toolbar_btn",style:"float:left;",text:getLangString("jxcommon.datepicker.today"),click:function(){var e=new Date;n.val(e.getFullYear()+"-"+JxUtil.adjustNumToFixString(e.getMonth()+1,2)+"-"+JxUtil.adjustNumToFixString(e.getDate(),2)),n.datepicker("hide")}}).appendTo(t),$("<span/>",{"class":"toolbar_btn",style:"float:right;",text:getLangString("jxcommon.datepicker.clear"),click:function(){$.datepicker._clearDate(e)}}).appendTo(t)},1)}})}function showDateTime(e,t){showDatePicker(e,t,"datetimepicker",{dateFormat:"yy-mm-dd",showSecond:!0})}function showTime(e,t){showDatePicker(e,t,"timepicker")}function showDatePicker(e,t,a,n){var r=$(e).attr("tid"),i=$("#"+r);n=$.extend({},{showButtonPanel:!1,duration:0,onClose:function(e){""!=e&&(i.attr("changed","1"),i.blur()),resizeDialogWhenFrame(!0)}},n),i[a](n),i.datepicker("show").unbind("focus").bind("focus",function(){$(this).datepicker("show"),resizeDialogWhenFrame()}),resizeDialogWhenFrame()}function addTo(e,t,a,n){var r="app.action?app="+a;null!=n&&""!=n&&(r=r+"&type="+n),window.location.href=r}function addToMe(e,t){addTo(e,t,jx_appName,null)}function addMe(){dwr.engine.setAsync(!1),WebClientBean.checkDataChange(jx_appNameType,{callback:function(e){return e?(alert(getLangString("jxcommon.unsave")),void dwr.engine.setAsync(!0)):void 0},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),WebClientBean.add(jx_appNameType,{callback:function(e){return e?void 0:(alert(getLangString("jxcommon.addFail")),void dwr.engine.setAsync(!0))},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),WebClientBean.getData(function(e){for(var t=document.getElementsByTagName("input"),a=0;a<t.length&&t[a];a++)if("text"==t[a].type){var n=t[a].attributes.dataattribute;if(n){var r=e[n.nodeValue];r&&(t[a].value=r)}}}),dwr.engine.setAsync(!0)}function checkFieldValid(e){var t=$(e);if(t.is("select:hidden")){var a=t.parent();("position"!=a.css("position")||"fixed"!=a.css("position"))&&a.css("position","relative").addClass("form_td_select_simulate_hidden")}var n=$(this).attr("format");n&&n.length>0&&""!=t.val()&&t.val(accounting.unformat(t.val()));var r=!t.validationEngine("validate",{focusFirstField:!0,maxErrorsPerField:1,showOneMessage:!0});return a&&a.removeClass("form_td_select_simulate_hidden"),r||$("html,body").animate({scrollTop:$(".formError").offset().top-55},100),r}function checkPassValidation(e){var t=$(e).closest("form"),a=!0,n=$("*[class *= 'validate[']",t);return n.each(function(){if($(this).is("select:hidden")){var e=$(this).parent();("position"!=e.css("position")||"fixed"!=e.css("position"))&&e.css("position","relative").addClass("form_td_select_simulate_hidden")}var t=$(this).attr("format");return t&&t.length>0&&""!=$(this).val()&&$(this).val(accounting.unformat($(this).val())),a=!$(this).validationEngine("validate",{focusFirstField:!0,maxErrorsPerField:1,showOneMessage:!0}),e&&e.removeClass("form_td_select_simulate_hidden"),a}),a||$("html,body").animate({scrollTop:$(".formError").offset().top-55},100),a}function duplicate(){WebClientBean.duplicate(jx_appNameType,{callback:function(e){null!=e&&showJboDetail(e)},errorHandler:errorHandler,exceptionHandler:exceptionHandler})}function beforeSave(){return debug("beforeSave..."),!0}function save(me,e){if("disabled"!=$(me).attr("disabled")){if($(me).attr("disabled","disabled"),!beforeSave(me,e))return void $(me).removeAttr("disabled");var passValidation=checkPassValidation(me,e);passValidation&&(submitData(),WebClientBean.save(jx_appNameType,{callback:function(jbos){var aSave=$(me).attr("afterSave");if(null!=aSave&&""!=aSave){var afterSaveFun=eval(aSave);if(new afterSaveFun(me,e),"Y"!=$(me).attr("afterSaveContinue"))return void $(me).removeAttr("disabled")}var flag=getUrlParam("flag"),myurl=window.location.href;myurl.indexOf(".action")>0&&myurl.indexOf("/app.action")<0?"add"==flag&&(myurl=myurl.replace("flag=add","uid="+eval(jbos.jbo.uidValue))):(myurl="app.action?app="+jx_appName,myurl="add"==flag?myurl+"&uid="+eval(jbos.jbo.uidValue):myurl+"&uid="+getUrlParam("uid")),dwr.engine.setAsync(!1),WebClientBean.saveMessage(jx_appNameType,getLangString("jxcommon.saveSuccess"),{callback:function(){saveCallback(me,e,myurl)},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0),$(me).removeAttr("disabled")},errorHandler:errorHandler,exceptionHandler:exceptionHandler})),$(me).removeAttr("disabled")}}function saveCallback(e,t,a){"false"!=$(e).attr("refresh")?window.location.href=encodeURI(a):showToolbarMsg(getLangString("jxcommon.saveSuccess"))}function previous(){dwr.engine.setAsync(!1),WebClientBean.previous(jx_appNameType,function(e){""!=e?showJboDetail(e):alert(getLangString("jxcommon.notprevious"))}),dwr.engine.setAsync(!0)}function next(){dwr.engine.setAsync(!1),WebClientBean.next(jx_appNameType,function(e){""!=e?showJboDetail(e):alert(getLangString("jxcommon.notnext"))}),dwr.engine.setAsync(!0)}function showJboDetail(e){var t=window.location.href,a=t.indexOf("?uid=");if(0>a&&(a=t.indexOf("&uid=")),a>0){var n=t.substring(0,a+1),r=t.substring(a,t.length),i=r.indexOf("&"),o="";i>0&&(o=r.substring(i,r.length)),window.location.href=n+"uid="+e+o}}function delListNoConfirm(e,t){var a="",n=$(e).attr("fragmentid"),r="ck_"+n;return $('input[name="'+r+'"]:checked').each(function(){a+=$(this).val()+","}),0==a.length?void alert(getLangString("jxcommon.chooseRecordToDel")):void WebClientBean.delList($("#"+n).attr("jboname"),a,{callback:function(e){getTableData("div_"+n,t),e||alert(getLangString("jxcommon.delFail"))},errorHandler:errorHandler,exceptionHandler:exceptionHandler})}function del(me,e){var confirmsg=$('<div id="delConfirm"></div>');confirmsg.attr("title",getLangString("jxcommon.delConfirmTitle")),confirmsg.html(getLangString("jxcommon.delConfirmMsg")),$(confirmsg).dialog({resizable:!1,height:180,modal:!0,buttons:[{text:getLangString("jxcommon.confirm"),click:function(){var jboname=$("#jboname").val(),uid=$("#uid").val();WebClientBean.delList(jboname,uid,{callback:function(data){data||alert(getLangString("jxcommon.delFail"));var aDel=$(me).attr("afterDel");if(null!=aDel&&""!=aDel){var afterDelFun=eval(aDel);if(new afterDelFun(me,e),"Y"!=$(me).attr("afterDelContinue"))return}$("span[mxevent='gotoapp']").click()},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),$(this).dialog("close")}},{text:getLangString("jxcommon.cancle"),click:function(){$(this).dialog("close")}}]})}function dellist(e,t){for(var a="",n=$(e).attr("fragmentid").split(","),r=n.length-1;r>=0;r--)if(0!=$("#"+n[r]).length){var i="ck_"+n[r];$('input[name="'+i+'"]:checked').each(function(){a+=$(this).val()+","})}else n.splice(r,1);if(0==a.length)return void alert(getLangString("jxcommon.chooseRecordToDel"));var o=$('<div id="delConfirm"></div>');o.attr("title",getLangString("jxcommon.delConfirmTitle")),o.html(getLangString("jxcommon.delConfirmMsg")),$(o).dialog({resizable:!1,height:180,modal:!0,buttons:[{text:getLangString("jxcommon.confirm"),click:function(){var e=$("#"+n[0]).attr("jboname");WebClientBean.delList(e,a,{callback:function(e){1==n.length?getTableData("div_"+n[0],t):window.location.reload(),e||alert(getLangString("jxcommon.delFail"))},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),$(this).dialog("close")}},{text:getLangString("jxcommon.cancle"),click:function(){$(this).dialog("close")}}]})}function delOwer(e,t){var a="",n=$(e).attr("fragmentid"),r="ck_"+n;if($('input[name="'+r+'"]:checked').each(function(){a+=$(this).val()+","}),0==a.length)return void alert(getLangString("jxcommon.chooseRecordToDel"));dwr.engine.setAsync(!1);var i=$("#"+n).attr("jboname");WebClientBean.checkJboOwer(i,a,{callback:function(a){a&&delList(e,t)},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0)}function search(e){if(e){var t=e.attributes.fragmentid.nodeValue;if(t){var a="list-search";if(e.attributes.apptype&&(a=e.attributes.apptype.nodeValue),t="div_"+t,node=document.getElementById(t)){var n="app.action";void 0!=$(e).attr("url")&&(n=$(e).attr("url")),appDialog(jx_appName,a,t,n)}}}}function searchOk(e,t){getTableData($("#fromid").val(),t,appDialogClose)}function searchAll(e,t){var a=[function(){searchClear(e,t),n()},function(){searchOk(e,t),n()}],n=function(){$(document).dequeue("mySearch")};$(document).queue("mySearch",a),n()}function searchClear(){$("input:text").val("");for(var e=$("select"),t=e.length,a=0;t>a;a++){var n=e.get(a),r=$("option[value='']",n);if(r&&r.length>0)r.attr("selected",!0);else{var i=getLangString("jxcommon.selectoption");$(e.get(a)).append("<option selected value=''>"+i+"</option>")}$(n).trigger("change")}var o=$("input[type='checkbox']");$.each(o,function(e,t){$(t).removeAttr("checked")}),WebClientBean.searchClear(jx_appNameType,"",{callback:function(){},errorHandler:errorHandler,exceptionHandler:exceptionHandler})}function inputOnChange(e,t){if(null!=e){var a=$(e);a.attr("changed","1");var n=$("#len"+e.id);if(n.length>0){var r=$(n).attr("maxvalue");null!=r&&(r-JxUtil.getByteLen(e.value)<0?(e.value=JxUtil.getByteVal(e.value,r),$(n).val(0)):$(n).val(r-JxUtil.getByteLen(e.value)))}else{var i=a.attr("class");if(i&&i.indexOf("custom[date")<0){var o=a.attr("length");o&&o-JxUtil.getByteLen(e.value)<0&&(e.value=JxUtil.getByteVal(e.value,o))}}setExpandSourceRowText(a,a.val());var l=a.attr("inputmode");("QUERYIMMEDIATELY"==l||"QUERY"==l)&&(t=$.event.fix(t||window.event),(13==t.keyCode||a.is(".hasDatepicker"))&&inputQueryOnBlur(e,t))}}function checkOnChange(e,t){if(null!=e){$(e).attr("changed","1");var a="checked"==$(e).attr("checked")?1:0;if("QUERY"==$(e).attr("inputmode")){if(dwr.engine.setAsync(!1),null==e)return;if(e.readOnly)return;if("0"==$(e).attr("changed"))return;$(e).attr("changed","0");var n=$(e).attr("dataattribute");if(void 0==n||""==n)return;n+=$(e).attr("cause"),WebClientBean.inputQueryOnBlur(jx_appNameType,"",n,a,{callback:function(){"QUERYIMMEDIATELY"==$(e).attr("inputmode")&&getTableData("div_"+$(e).attr("fragmentid"),t)},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0)}else{var r=$(e).attr("chk"),i=$(e).attr("notchk"),o=$(e).val();$(e).val(o==r?i:r)}}}function inputOnFocus(e){if(!(null==e||e.readOnly&&$(e).attr("datatype")&&"date"!=$(e).attr("datatype"))){var t=$(e).attr("format");if(t&&t.length>0&&""!=$(e).val()){var a=accounting.unformat($(e).val());$(e).val(a)}}}function inputOnBlur(e){if(!(null==e||e.readOnly&&$(e).attr("datatype")&&"date"!=$(e).attr("datatype"))){var t=$(e).attr("changed");if("0"!=t&&null!=t&&""!=t){var a=$(e).attr("dataattribute");if(void 0!=a&&""!=a&&!$(e).validationEngine("validate")){var n=$(e).val(),r=$(e).attr("format");if(r&&r.length>0&&""!=n){var i=accounting.formatMoney(n);$(e).val(i)}$(e).attr("changed","0");var o="#"+e.id+"_DESC";if(0==$(o).length)try{o=$(o,parent.document)}catch(l){}var d=$(e).closest("form").attr("relationship");d=void 0==d?"":d,WebClientBean.inputOnBlur2(jx_appNameType,$(e).attr("dataattribute"),n,$(o).attr("dataattribute"),d,{callback:function(t){null!=t&&setData($(e).closest("table[class='table_edit']"),t,"")},errorHandler:errorHandler,exceptionHandler:exceptionHandler})}}}}function tableInputOnBlur(e){if(!(null==e||e.readOnly&&$(e).attr("datatype")&&"date"!=$(e).attr("datatype"))){var t=$(e).attr("changed");if("0"!=t&&null!=t&&""!=t){$(e).attr("changed","0");var a=$(e).attr("dataattribute"),n=e.id.substring(0,e.id.length-a.length-1),r=n.substring(0,n.lastIndexOf("_"));n="tr_"+n;var i=$("#"+r).attr("jboname"),o=$("#"+r).attr("relationship"),l=$("#"+n).attr("uid"),d=$(e).val();"input"!=e.tagName&&"INPUT"!=e.tagName||"checkbox"!=$(e).attr("type")||(d="checked"==$(e).attr("checked")?1:0),WebClientBean.tableInputOnBlur(jx_appNameType,a,d,i,o,l,{callback:function(t){null!=t&&setData($(e).closest("tr"),t,"TABLE")},errorHandler:errorHandler,exceptionHandler:exceptionHandler})}}}function inputQueryOnBlur(e,t){if(null!=e&&!e.readOnly){var a=$(e),n=$.trim(a.val());if(dwr.engine.setAsync(!1),"0"!=a.attr("changed")||a.is("select")){a.attr("changed","0");var r=a.attr("dataattribute");if(void 0!=r&&""!=r){var i=a.attr("cause");i&&(-1!=r.indexOf(".")?WebClientBean.getRelationShipCause(jx_appNameType,r,i,{callback:function(e){i=e},errorHandler:errorHandler,exceptionHandler:exceptionHandler}):i=r+i,WebClientBean.inputQueryOnBlur(jx_appNameType,"",i,n,{callback:function(){"QUERYIMMEDIATELY"==a.attr("inputmode")&&getTableData("div_"+a.attr("fragmentid"),t)},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0))}}}}function labelsQuery(e,t){if(null!=e){var a=$(e).closest("form").attr("relationship");a=void 0==a?"":a;for(var n=$(e).parent();null!=n&&null==$(n).attr("fragment");)n=n.parent();var r=$(e).attr("dataattribute");void 0!=r&&""!=r&&WebClientBean.inputQueryOnBlur(jx_appNameType,a,$(e).attr("dataattribute")+$(e).attr("cause"),$(e)[0].innerText,{callback:function(){getTableData($(n)[0].id,t,null,null,2)},errorHandler:errorHandler,exceptionHandler:exceptionHandler})}}function selectChange(e,t){var a=$(e);if("DISPLAY"!=a.attr("inputmode")){if(a.is("select:hidden")){var n=a.parent();("position"!=n.css("position")||"fixed"!=n.css("position"))&&n.css("position","relative").addClass("form_td_select_simulate_hidden")}var r=a.validationEngine("validate");if(n&&n.removeClass("form_td_select_simulate_hidden"),r)return!1;setExpandSourceRowText(a,a.find("option:selected").text());var i=$(e).attr("dataattribute");if(void 0!=i&&""!=i){var o=a.attr("inputmode");if("DISPLAY"!=o)if("QUERYIMMEDIATELY"==o||"QUERY"==o){dwr.engine.setAsync(!1);var l=a.attr("workflowid"),d=a.attr("tableid");null!=l&&null!=d&&""!=l&&""!=d?workflowQueryOnBlur(e):inputQueryOnBlur(e,t),doPartialTriggers(e,t),dwr.engine.setAsync(!0)}else dwr.engine.setAsync(!1),WebClientBean.inputOnBlur(jx_appNameType,$(e).attr("dataattribute"),e.value,{callback:function(t){if(t){var n=($(e).attr("refresh")||"").toLowerCase();null!=t&&"false"!=n&&setData(a.closest("table[class='table_edit']"),t,"")}else alert(getLangString("jxcommon.submitdataerror")+"JS-selectChange-inputOnBlur")},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),doPartialTriggers(e,t),dwr.engine.setAsync(!0)}}}function tableSelectChange(e,t){var a=$(e).parent().closest("table"),n=$(e).parent().closest("tr"),r=n.attr("uid"),i=a.attr("jboname"),o=a.attr("relationship"),l=$(e).attr("dataattribute");if(void 0!=l&&""!=l){var d=new Array;$("option:selected",$(e)).each(function(){d.push($(this).val())}),dwr.engine.setAsync(!1),WebClientBean.tableInputOnBlur(jx_appNameType,l,d.toString(),i,o,r,{callback:function(e){null!=e&&setData(n,e,"TABLE")},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),doPartialTriggers(e,t),dwr.engine.setAsync(!0)}}function doPartialTriggers(me,e,dv,dn){var partialTriggers=$(me).attr("partialTriggers");if(partialTriggers){var trigs=partialTriggers.split(","),i;for(i=0;i<trigs.length;i++){var trigTarget=$("#"+trigs[i]);0==trigTarget.length&&(trigTarget=$("[dataattribute='"+trigs[i].toUpperCase()+"']",$(me).closest("tr")));var tagName="";if(trigTarget.length>0&&(tagName=trigTarget[0].tagName),"select"==tagName||"SELECT"==tagName){var partialCause=trigTarget.attr("partialCause");if(null!=partialCause){partialCause=""==$(me).find("option:selected").val()?"":partialCause.replace(/\?/g,$(me).find("option:selected").val());var attrs=new Array;attrs[0]=trigTarget.attr("displayvalue"),attrs[1]=trigTarget.attr("displayname");var dv=attrs[0].toLowerCase(),dn=attrs[1].toLowerCase();dwr.engine.setAsync(!1),WebClientBean.getJsonData(trigTarget.attr("jboname"),trigTarget.attr("relationship")||"",(trigTarget.attr("wherecause")||"")+partialCause,trigTarget.attr("orderby"),attrs,{callback:function(data){trigTarget.empty();var opts=trigTarget.attr("options");if(null!=opts&&opts.length>0)for(var optslist=opts.split(","),m=0;m<optslist.length;m++){var ov=optslist[m].split(":"),ov1=optslist[m],ov2=optslist[m];ov.length>=2&&(ov1=ov[0],ov2=ov[1]);var no="<option value='"+ov1+"'>"+ov2+"</option>";trigTarget.append(no)}for(var options=eval("({items: ["+data+"]})"),j=0;j<options.items.length;j++){var newOpts="<option value='"+options.items[j][dv]+"'>"+options.items[j][dn]+"</option>";trigTarget.append(newOpts)}trigTarget.val(null).trigger("change")},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0),inputQueryOnBlur(trigTarget,e),doPartialTriggers(trigTarget,e)}}else if("form"==tagName||"FORM"==tagName){var clause=$(me).attr("partialCause"),value=$(me).val();WebClientBean.getJboByCause($("#jboname").val(),clause,value,{callback:function(e){if(null!=e){var t=$(".table_edit",trigTarget);setData(t,e,"")}},errorHandler:errorHandler,exceptionHandler:exceptionHandler})}}}}function getTableData(e,t,a,n,r){if(null==e||""==e||"div_"==e)return void a();var i=!1,o=$("#"+e);if((null==o||0==o.length)&&(o=$("#"+e,parent.document),i=!0),(null==o||0==o.length)&&(i=!1,o=$("#div_"+e)),(null==o||0==o.length)&&(o=$("#div_"+e,parent.document),i=!0),o){if(void 0==o.attr("id"))return void(null!=a&&a());var l=o.attr("id").substring(4),d=o.attr("url"),c=o.attr("type"),s=null,u=null,p=null,g=null,m=null,f=null,h=null,v=null,b=null;i&&null!=parent?(s=parent.jx_appName,u=parent.jx_appType,p=$("#"+l+"_pagenum",parent.document),g=$("#"+l+"_topage",parent.document),m=$("#"+l+"_pagecount",parent.document),f=$("#"+l+"_pagesort",parent.document),h=$("#"+l+"_pagesize",parent.document),v=$("#"+l,parent.document).attr("jboname"),b=$("#"+l,parent.document).attr("relationship")):(s=jx_appName,u=jx_appType,p=$("#"+l+"_pagenum"),g=$("#"+l+"_topage"),m=$("#"+l+"_pagecount"),f=$("#"+l+"_pagesort"),h=$("#"+l+"_pagesize"),v=$("#"+l).attr("jboname"),b=$("#"+l).attr("relationship"));var x=1;if(g.length>0&&(x=g.val(),(!isInteger(x)||x-m.val()>0||0>x)&&(x=m.val())),p.length>0&&p.val(x),(null==d||""==d)&&(d="app.action"),null==n||""==n){var w=null;i&&null!=parent?thead=w=$("th",$("#"+l+" thead:first",parent.document)):w=$("th:last",$("#"+l+" thead:first")),w.length>2&&(n="",$.each(w,function(){var e=$(this).attr("dataattribute");void 0!=e&&e.length>0&&(n=n+e+",")}))}else"init"==n&&(n="");loadingMask(o,o.find("tr").length),o.load(d,{app:s,type:c,apptype:u,pagenum:-1==x?1:x,pagesize:-1==h.val()?20:h.val(),orderby:f.val(),custColumns:n,jboname:v,relationship:b,url:d,loadType:r},function(t,n){if(loadingUnmask(o),"error"==n)o.html("<div class='text-center' style='color:#f30;padding:20px 0;'>loading error</div>");else{var r=$("tbody",o);$("tr[tobeadd='true']",o).each(function(){$(this).find("select").removeAttr("disabled"),r.prepend(this)}),$("tr[toBeDel='true']",o).each(function(){delrow($(this).find("[mxevent='delrow']"))}),bindTableEvent(l),null!=a&&a(),"attachment"==s&&resetIframeHeight(e)}})}}function afterFragmentLoad(){}function gotoapp(e){var t=$(e).attr("appName"),a=$(e).attr("appType"),n=$(e).attr("url");null==n?n="app.action?app="+t+"&type="+a+"&fromUid="+$("#uid").val():"Y"==$(e).attr("localparams")&&(n+=location.search);var r=$(e).attr("paramid");null!=r&&""!=r&&(n+=$("#"+r).val()),null!=$(e).attr("context")&&(n=contextPath+n);var i=$(e).attr("target");dwr.engine.setAsync(!1),WebClientBean.checkDataChange(jx_appNameType,function(e){if(e){var t=$('<div id="delConfirm"></div>');t.attr("title",getLangString("jxcommon.dataChangeConfirmTitle")),t.html(getLangString("jxcommon.dataChangeConfirmMsg")),$(t).dialog({resizable:!1,width:320,height:200,modal:!0,buttons:[{text:getLangString("jxcommon.confirm"),click:function(){$(this).dialog("close"),WebClientBean.rollback(jx_appNameType,{callback:function(){null==i?location.href=n:windowopen(n,i)},errorHandler:errorHandler,exceptionHandler:exceptionHandler})}},{text:getLangString("jxcommon.cancle"),click:function(){$(this).dialog("close")}}]})}else null==i?location.href=n:windowopen(n,i)}),dwr.engine.setAsync(!0)}function appDialog(e,t,a,n,r,i,o,l){var d=$("<div id='dialogCenterPoint' class='dialog_center_point'></div>");$(document.body).append(d);var c="";if(null==n||""==n?(n="app.action",c=n+"?app="+e+"&type="+t+"&fromid="+a):c=""==e&&""==t?n+"?fromid="+a:n.indexOf("?")<0?n+"?app="+e+"&type="+t+"&fromid="+a:n+"&app="+e+"&type="+t+"&fromid="+a,c.indexOf("?")>0&&c.indexOf("=")>0&&c.indexOf("&")>0){for(var s="",u=c.split("?"),p=u[0],g=u[1].split("&"),m=0;m<g.length;m++){var f=g[m].split("="),h=f[0],v=f[1];0==m?(h="fromUid"==h?h:h.toLowerCase(),s="?"+h+"="+v):(h="fromUid"==h?h:h.toLowerCase(),s=s+"&"+h+"="+v)}c=p+s}var b=100,x=150;$(".dialog").remove();var w=$("<div class='dialog'></div>");w.attr("id",a+"div");var y=$("<div class='dialog_waitting'></div>"),T=$("<iframe frameBorder='0' style='overflow:visible' width='100%' onload='appdialogIframeLoaded(this)' height='100%'></iframe>");w.append(y).append(T),T.attr("id",a+"frame").attr("src",c),fixIEProcessBar(),r>0&&(b=r),i>0&&(x=i),isMobile()&&(b="98%"),T.attr("pwidth",b),T.attr("pheight",x);var k={autoOpen:!1,modal:!0,height:x,width:b,title:l?l:"",resizable:!0,draggable:!0,beforeClose:null==o?dialogBeforeClose:o,close:dialogClose,resize:function(e,t){isMobile()?T.attr("width","96%"):T.attr("width",t.size.width-30)}};w.dialog(k),w.dialog("open"),w.dialog("option","position",{my:"center",at:"center",of:d}),w.prev().find("button").blur()}function fixIEProcessBar(){if(/msie/.test(navigator.userAgent.toLowerCase())){var e=$("<iframe style='display:none'/>").appendTo(top.document.body);e[0].contentDocument.write(""),e[0].contentWindow.close()}}function appdialogIframeLoaded(e){var t=e.id,a=t.substring(0,t.length-5),n=$("#"+a+"div"),r=e.contentDocument.body,i=r.scrollWidth,o=r.scrollHeight+60,l=+$(e).attr("pwidth"),d=+$(e).attr("pheight");o=150==d?o:d,i=l>i?l:i,e.setAttribute("width",i+10),i+=30,n.dialog({width:i,height:o}),e.contentWindow.initWidth=i,e.contentWindow.initHeight=o,$(e).show(),$(".dialog_waitting",$(e).parent()).hide(),e.contentWindow.$currentDialog=n}function dialogBeforeClose(){}function dialogClose(e){$("#dialogCenterPoint").remove();var t=e.target,a=t.id;a.length>0&&(a=a.substring(4),a=a.substring(0,a.length-3),$("#"+a).length>0&&"TABLE"==$("#"+a)[0].tagName&&loadDataTable(a))}function appDialogClose(){try{var e="#fromid";0==$(e).length&&(e=$(e,parent.document));var t=$(e).val();if(t&&void 0!=t){var a=window.parent.$("#"+t+"div");a.dialog("close")}else if(JxUtil.isTopWindow())window.opener=null,window.close();else{var n=window.parent.$(".dialog");n.length&&n.dialog("close")}}catch(r){debug("appDialogClose : "+r)}}function lookupAction(e,t,a,n){if(a=a||0,n=n||0,e.toLowerCase().indexOf(".action")>0)appDialog(jx_appName,jx_appType,t,e,a,n);else if(e.indexOf("?")>0){var r=e.split("?");r.length>1&&appDialog(r[0],"lookup_list&"+r[1],t,null,a,n)}else appDialog(e,"lookup_list",t,null,a,n)}function lookup(e){var t=$(e).attr("tag");if(t&&"tablebutton"==t){var a=$(e).closest("table"),n=a.closest(".dataTables_scrollHead"),r=$("input[type='checkbox'][name='allbox']",a);if(n.length&&(a=n.next().find("table")),!(r&&r.length>0))return void debug("非多选的窗口，你干嘛非要用这种实现？ 请用默认实现方式!");var i=$("input[type='checkbox'][name!='allbox']:checked",a);if(i&&i.length>0){var o="";$.each(i,function(e,t){o+=$(t).val(),e<i.length-1&&(o+=",")});var l=$("#fromid").val(),d=$("#"+l,parent.document);if(d&&d.length>0){var c=d.closest("table"),s=c.attr("jboname"),u=c.attr("relationship");dwr.engine.setAsync(!1),WebClientBean.lookup(jx_appNameType,a.attr("jboname"),a.attr("relationship"),o,parent.jx_appNameType,s,u,{callback:function(e){if("success"==e){var t="#fromid";0==$(t).length&&(t=$(t,parent.document));var a=$(t).val(),n=window.parent.$("#"+a+"div");n.dialog("close"),parent.window.getTableData("div_"+c.attr("id"),null,null,null,1),n.remove()}},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0)}}else alert(getLangString("jxcommon.notchoose"))}else{var p=$(e).attr("tid"),g=$(e).closest("tr"),m="#fromid";0==$(m).length&&(m=$(m,parent.document));var f=$(m).val(),h=$(m).val(),v=window.parent.$("#"+h+"div");v.dialog("close");var b="#"+h;0==$(b).length&&(b=$(b,parent.document)),$(b).val(p),$(b).attr("changed","1");var x=$("#"+h+"_DESC");if(0==x.length&&(x=$("#"+h+"_DESC",parent.document)),0!=x.length){var f=x.attr("dataattribute");f.indexOf(".")>0&&(f=f.split(".")[1]);var w="";$("td",g).each(function(){return $(this).attr("dataattribute")==f?void(w=$(this).attr("title")):void 0}),x.val(w)}var y=x.closest("form").find(".formErrorContent");void 0!=y&&y.parent().remove(),$(b).focus(),$(b).blur(),v.remove()}}function lookupClear(e){var t=$(e).siblings("input");$.each(t,function(e,t){$(t).focus(),$(t).val(""),$(t).attr("changed",1),$(t).blur()}),$(e).focus()}function report(e){var t=$(e).attr("appname"),a=$(e).attr("target");null!=a&&a.length>0&&$("form:first").attr("target",a),$("form:first").attr("action",reportUrl+t).submit()}function selectAppInboxStatus(e){dwr.engine.setAsync(!1);{var t=$(e).val();$(e).attr("fragmentid")}"1"==t||"2"==t?($("#n_"+e.id).css("display",""),$("#l_"+e.id).css("display","")):($("#n_"+e.id).css("display","none"),$("#l_"+e.id).css("display","none")),"1"==t?$("#r_n_"+e.id).css("display",""):$("#r_n_"+e.id).css("display","none"),WebClientBean.selectAppInboxStatus(jx_appNameType,t,$(e).attr("statusColumn"),$(e).attr("creatorColumn"),$(e).attr("transactorColumn"),$(e).attr("backflagColumn"),{callback:function(){getTableData($(e).attr("fragmentId"))},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0)}function selectAppInboxNode(e){dwr.engine.setAsync(!1);var t=$(e).val();WebClientBean.selectAppInboxNode(jx_appNameType,t,{callback:function(){},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),getTableData($(e).attr("fragmentId")),dwr.engine.setAsync(!0)}function showWorkflowInfo(){}function routeDialog(e){var t=[],a=$(e).attr("fragmentid"),n=e.id.substr(2),r="ck_"+a;if($('input[name="'+r+'"]:checked').each(function(){t.push($(this).val())}),0==t.length)return void alert(getLangString("jxcommon.chooseRecordToRoute"));var i=$("#"+a).attr("jboname"),o="1";$("#"+n).val()==$("#"+n).attr("firstActTaskId")&&(o="0");$("#status").val(),$("#nextStatus").val();dwr.engine.setAsync(!1),WebClientBean.getAppWorkflowParam(jx_appNameType,{callback:function(e){if(e){var n="app.action?fromUid="+t+"&fromApp="+jx_appName+"&fromAppType="+jx_appType+"&fromJboname="+i+"&backflag="+o;appDialog("workflow","workflow",a,n,"auto","300px")}},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0)}function beforeRouteme(){return!0}function routeme(me,e){if(beforeRouteme(me,e)){var passValidation=checkPassValidation(me,e);if(passValidation&&(passValidation=!1,dwr.engine.setAsync(!1),submitData(),WebClientBean.save(jx_appNameType,{callback:function(jbos){var aSave=$(me).attr("afterSave");if(null!=aSave&&""!=aSave){var afterSaveFun=eval(aSave);if(new afterSaveFun(me,e),"Y"!=$(me).attr("afterSaveContinue"))return}null!=jbos&&(passValidation=!0)},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0),passValidation)){var uid=$("#uid").val();if(null==uid||""==uid||"undefined"==uid)return void alert(getLangString("jxcommon.route.error1"));var jboname=$("#jboname").val();(null==jboname||""==jboname||"undefined"==jboname)&&alert(getLangString("jxcommon.route.error2"));var status=$("#status").val(),nextStatus=$("#nextStatus").val(),instanceid=$("#instanceid").val(),bpmInstanceId="",idx=instanceid.indexOf("#");if(bpmInstanceId=idx>0?instanceid.substring(0,idx):instanceid,""!=bpmInstanceId&&bpmInstanceId.length>2&&bpmInstanceId.indexOf("JXBPM.")>=0){var myurl=contextPath+"/jxbpm/route.action?fromUid="+uid+"&fromApp="+jx_appName+"&fromAppType="+jx_appType+"&fromJboname="+jboname+"&instanceid="+bpmInstanceId,fromId=me.id;
(void 0==fromId||""==fromId)&&(fromId="workflow"),appDialog(jx_appName,jx_appType,fromId,myurl,650,150,null,getLangString("jxcommon.routeme.title"))}else dwr.engine.setAsync(!1),WebClientBean.getAppWorkflowParam(jx_appNameType,{callback:function(e){if(""!=e){var t=contextPath+"/app.action?fromUid="+uid+"&fromApp="+jx_appName+"&fromAppType="+jx_appType+"&fromJboname="+jboname+"&instanceid="+bpmInstanceId,a=me.id;(void 0==a||""==a)&&(a="workflow"),appDialog("workflow","workflow?engine="+e,a,t,650,150,null,getLangString("jxcommon.routeme.title"))}else alert(getLangString("jxcommon.loadbpmconfigerror"))},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0)}}}function routeCommon(e,t){if("disabled"!=$(e).attr("disabled")){var a=$('input[name="action"]:checked'),n=a.val(),r=a.attr("id"),i=$("label[for='"+r+"']").text();if(void 0==n)return void alert(getLangString("jxcommon.bpm.needaction"));var o=$("select",$("div[useraction]:visible")),l=new Array;if(o.length&&($("option:selected",o).each(function(){l.push($(this).val())}),!l.length))return void alert(getLangString("jxcommon.bpm.needuser"));var d=$("#noteRequired").css("display"),c=$("#note").val();if(void 0!=d&&"none"!=d&&""==c)return void alert(getLangString("jxcommon.bpm.neednote"));void 0==c&&(c=""),$(e).attr("disabled","disabled"),c=i+";"+c,dwr.engine.setAsync(!1);var s=$("#fromApp").val(),u=$("#fromAppType").val(),p=$("#fromJboname").val(),g=$("#fromUid").val(),m="",f="";$("input[name='tousers']:checked").each(function(){m+=$(this).val()+","}),m+=l,WebClientBean.routeCommon(s+"."+u,p,g,n,c,m,f,{callback:function(e){alert(e),WebClientBean.reloadCurrentJboData({callback:function(){var e=parent.location.href;e.indexOf("flag=add")>-1&&(e=e.replace(/flag=add/,"uid="+g)),window.parent.location.href=e},errorHandler:errorHandler,exceptionHandler:exceptionHandler})},errorHandler:errorHandler,exceptionHandler:exceptionHandler});var h=$("#fromid").val();null==h||""==h?appDialogClose(e,t):getTableData("div_"+$("#fromid").val(),t,appDialogClose),dwr.engine.setAsync(!0)}}function route(e,t,a,n){if(void 0==a&&void 0==n)return void routeme(e,t);var r=$("#noteRequired").css("display");if("none"!=r&&""==$("#note").val())return void alert(getLangString("jxcommon.bpm.neednote"));dwr.engine.setAsync(!1);var i=$("#fromApp").val(),o=$("#fromJboname").val(),l=$("#fromUid").val(),d="",c="";$("input[name='tousers']:checked").each(function(){d+=$(this).val()+","}),c+="[";var s=$("form[id^='wftParamForm_']");$.each(s,function(e,t){var a="{",n=$("#wftParamKey",t).val();a=a+"'key':'"+n+"',";var r=$("#jboname",t).val();a=a+"'jboname':'"+r+"'",a+=",'attr':[";var i=$(".table_edit tr",t);$.each(i,function(e,t){a+="{";var n=$(".form_td_content input",t).attr("dataattribute"),r=$(".form_td_content input",t).val();a=a+"'attribute':'"+n+"',",a=a+"'value':'"+r+"'",a+="}",e<i.length-1&&(a+=",")}),a+="]",a+="}",c+=a,e<s.length-1&&(c+=",")}),c+="]",WebClientBean.route(i,o,l,n,a,$("#note").val(),d,"[]"==c?"":c,{callback:function(e){alert(e),WebClientBean.reloadCurrentJboData({callback:function(){window.parent.location.reload()},errorHandler:errorHandler,exceptionHandler:exceptionHandler})},errorHandler:errorHandler,exceptionHandler:exceptionHandler});var u=$("#fromid").val();null==u||""==u?appDialogClose(e,t):getTableData("div_"+$("#fromid").val(),t,appDialogClose),dwr.engine.setAsync(!0)}function routeOk(e,t){route(e,t,1,null)}function routeBack(e,t){route(e,t,2,null)}function routeBackLast(e,t){route(e,t,4,null)}function routeCancel(e,t){route(e,t,8,null)}function expexcel(){dwr.engine.setAsync(!1),WebClientBean.preExpExcel(jx_appNameType,{callback:function(e){if(e>0){var t=$('<div id="delConfirm"></div>');t.attr("title",getLangString("jxcommon.tip"));var a=getLangString("jxcommon.expexcelmsgstart")+$.trim(e)+getLangString("jxcommon.expexcelmsgend");t.html(a),$(t).dialog({resizable:!1,width:320,height:200,modal:!0,buttons:[{text:getLangString("jxcommon.confirm"),click:function(){$(this).dialog("close"),expExcel()}},{text:getLangString("jxcommon.cancle"),click:function(){$(this).dialog("close")}}]})}else expExcel()},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0)}function expExcel(){var e=$("#appName",window.parent.document).text(),t=$("#appName",window.parent.document).html();e||e.length<=0&&(e=t),WebClientBean.expExcel(jx_appNameType,e,{callback:function(e){$("body",window.parent.document).unmask(),dwr.engine.openInDownload(e)},async:!1,errorHandler:errorHandler,exceptionHandler:exceptionHandler})}function exportExcel(e){bIsIE?sUserAgent.indexOf("msie 6.0")>0||sUserAgent.indexOf("msie 7.0")>0?exportByServer(e,"excel"):exportExcelForIE(e):exportByServer(e,"excel")}function exportWord(e){bIsIE?sUserAgent.indexOf("msie 6.0")>0||sUserAgent.indexOf("msie 7.0")>0?exportByServer(e,"word"):exportWordForIE(e):exportByServer(e,"word")}function exportByServer(e,t){var a=$("#div_"+e).html();a=a.replace($("#foot_"+e).html(),"");var n=$("<form method='post' action='./export' style='display:none' enctype='application/x-www-form-urlencoded;charset=utf-8'><textarea name='context'>"+a+"<textarea/><input type='hidden' name='filetype' value='"+t+"'></form>");n.submit()}function exportExcelForIE(e){window.clipboardData.setData("Text",$("#div_"+e).html().replace($("#foot_"+e).html(),""));try{{var t=new ActiveXObject("Excel.Application"),a=t.workbooks.add();a.worksheets(1)}t.DisplayAlerts=!1,t.visible=!0}catch(n){return exportByServer(e),!1}a.worksheets(1).Paste}function exportWordForIE(tbid){var divid=eval("div_"+tbid),oWD=new ActiveXObject("Word.Application"),oDC=oWD.Documents.Add("",0,1),oRange=oDC.Range(0,1),sel=document.body.createTextRange();sel.moveToElementText(divid),sel.select(),sel.execCommand("Copy"),oRange.Paste(),oWD.Application.Visible=!0}function attachment(e){var t=$(e).attr("uid"),a=$(e).attr("upath"),n=$(e).attr("type"),r=$(e).attr("vfolder"),i=a+"&cols="+$(e).attr("cols")+"&iw="+$(e).attr("imgwidth")+"&ih="+$(e).attr("imgheight")+"&it="+$(e).attr("imgtype");void 0!=r&&(i=i+"&vfolder="+r),"IMGLIST"==n?appDialog("attachment","imglist",t,i,700,150):appDialog("attachment","list",t,i,700,150)}function custcolumn(e){if(null!=e&&""!=e){if(sUserAgent.indexOf("msie 6.0")>0||sUserAgent.indexOf("msie 7.0")>0)return alert("对不起，您的浏览器版本太低，不支持此功能。"),void $("#"+e).css("display","none");var t=$("#"+e).attr("jboname"),a=$("#"+e).attr("relationship");appDialog("customcolumn","list",e,"app.action?objectname="+t+"&relationship="+a,"auto","400px")}}function tableFullScreen(e){$("#div_"+e).dialog({height:"auto",width:"100%",resizable:!0,modal:!0})}function delrowwithconfirm(e){var t=($(e).attr("id"),$(e).closest("tr")),a=(t.attr("id"),$(e).closest("table")),n=a.attr("id"),r=$('<div id="delConfirm"></div>');r.attr("title",getLangString("jxcommon.delConfirmTitle")),r.html(getLangString("jxcommon.delConfirmMsg")),$(r).dialog({resizable:!1,height:180,modal:!0,buttons:[{text:getLangString("jxcommon.confirm"),click:function(){WebClientBean.delRow(jx_appNameType,a.attr("jboname"),a.attr("relationship"),t.attr("uid"),!0,{callback:function(e){e&&WebClientBean.save(jx_appNameType,function(){getTableData("div_"+n)})}}),$(this).dialog("close")}},{text:getLangString("jxcommon.cancle"),click:function(){$(this).dialog("close")}}]})}function delrow(e){var t=$(e).attr("id"),a=$(e).closest("tr"),n=a.attr("id"),r=$(e).closest("table"),i=(r.attr("id"),$(e).attr("flag"));void 0!=r.attr("expandtype")&&"1"==a.attr("expand")&&$("td:first span",a).click(),dwr.engine.setAsync(!1),"0"==i?WebClientBean.delRow(jx_appNameType,r.attr("jboname"),r.attr("relationship"),a.attr("uid"),!0,{callback:function(e){if(e)if("true"==$("#"+n).attr("tobeadd")){var r=$("#"+n).prev();r.length||(r=$("#"+n).next()),r.length?($("#"+n).remove(),r.trigger("click")):getTableData("div_"+$("#"+n).closest("table").attr("id"),null,null,null,1)}else{var i=$("#"+n).clone();a.css("display","none"),i.find("script").remove(),i.attr("id",a.attr("id")+"_del"),a.before(i),$("input, select, checkbox, img",i).each(function(e,t){$(t).hasClass("lookupicon")&&$(t).remove(),$(t).attr("disabled","disabled").attr("readonly","readonly").removeAttr("required");var a=$(t),n=a.attr("class");void 0!=n&&$.each(n.split(" "),function(e,t){void 0!=t&&t.indexOf("validate")>=0&&a.removeClass(t)})});var o=$("td:first",i).html(),l=o.indexOf("<script"),d=o.indexOf("</script>");l>0&&d>0&&(o=o.substring(0,l)+o.substring(d+9));var c=i[0].clientWidth-$("td:last",i)[0].clientWidth;$("td:first",i).html("<div style='position: relative;z-index:16;' class='rowDelLine'>"+o+"<div style='width:"+c+"px;position:absolute;top:50%;border-bottom:solid 1px #000'></div></div>"),$("#"+t).attr("flag","1");var s=$("#"+t).attr("src").replace("delrow","undelrow");$("#"+t).attr("src",s).removeAttr("disabled").find(".select2").css({"z-index":15})}else alert(getLangString("jxcommon.delFail"))},errorHandler:errorHandler,exceptionHandler:exceptionHandler}):WebClientBean.delRow(jx_appNameType,r.attr("jboname"),r.attr("relationship"),a.attr("uid"),!1,{callback:function(e){e?(a.next().show().trigger("click"),a.remove()):alert(getLangString("jxcommon.undelFail"))},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0)}function addrow(e,t){addRowAndSetValue(e,t,null)}function addRowAndSetValue(e,t,a){var n=e.id.substring(0,e.id.length-$("#"+e.id).attr("mxevent").length-1),r=$("#"+n);if("0"==$(e).attr("enabled"))return void alert(getLangString("jxcommon.addFail"));$(e).attr("enabled","0");var i=void 0==r.attr("expandtype")?!1:!0;if(i){var o=$("tr[expand='1']",r);$("td:first span",o).click()}WebClientBean.addRow(jx_appNameType,r.attr("jboname"),r.attr("relationship"),a,{callback:function(t){null==t?alert(getLangString("jxcommon.addFail")):(getTableData("div_"+n,null,null,null,1),$(e).attr("enabled","1"))},errorHandler:errorHandler,exceptionHandler:exceptionHandler})}function add(e){WebClientBean.canJboSetAdd(jx_appNameType,{callback:function(t){if(t){var a=$(e).attr("addurl");null==a&&(a="./app.action"),a+=a.indexOf("?")>0?"&":"?",a+="flag=add&app="+jx_appName,window.location.href=a}else alert(getLangString("jxcommon.addFail"))},errorHandler:errorHandler,exceptionHandler:exceptionHandler})}function renderCKEditor(e){if(null!=e){var t=$("#"+e);if(t&&t[0]){CKEDITOR.config.language=userLangeCode,CKEDITOR.config.filebrowserImageUploadUrl=contextPath+"/ckedituploadimg.action";var a=$("#"+e)[0].tagName;if("DIV"==a||"readonly"==$("#"+e).attr("readonly")){CKEDITOR.disableAutoInline=!0,CKEDITOR.config.allowedContent=!0;var n=CKEDITOR.inline(e,{readOnly:!0,toolbar:[]})}else{var r=$("#"+e).attr("renderExtends");""==r&&(r="BASE");var n=CKEDITOR.replace(e,{toolbar:r,on:{change:function(){$("#"+e).attr("changed","1"),n.updateElement(),$("#"+e).blur()},blur:function(){n.updateElement(),$("#"+e).blur()},key:function(){}}})}}}}function submitData(){}function href(e){var t=$(e).attr("params");if(null!=t&&""!=t){var a=$(e).attr("target");null!=a&&""!=a?windowopen(t,a):location.href=t}}function setData(e,t,a){setFormData(e,t,a),$("table[relationship!=''][jboname!='']",e).each(function(){var a=$(this).attr("relationship"),n=$("#jboname",e.closest("form")).val();n=n.toUpperCase();var r=null;if(t.children&&(r=t.children[n+"."+a],("undefined"==typeof r||null==r)&&(r=t.children[n+"."+a+"."+t.uidValue])),null!=r&&null!=r.jbo){var i=n+"."+a;if(void 0!=$(this).attr("id"))getTableData("div_"+$(this).attr("id"),null,null,null,1);else try{var o=$(this).closest("td").children("div").eq(0);getTableData($(o).attr("id"),null,null,null,1)}catch(l){debug("子表"+i+"刷新失败")}}})}function setFormData(e,t,a){$("select[dataattribute!=''],input[type='text'][dataattribute!=''],textarea[dataattribute!=''],input[type='textbox'][dataattribute!=''],label[dataattribute!=''],input[type='checkbox'][dataattribute!='']",e).each(function(){if(!($(this).attr("class")&&$(this).attr("class").indexOf("form_label_tip")>=0)){var n=$(this).attr("dataattribute"),r=this.tagName,i=null;if(void 0!=n&&n.indexOf(".")>0){var o=n.split("."),l=$("#jboname",e.closest("form")).val();"TABLE"==a&&(l=e.closest("table[jboname!='']").attr("jboname")),l=l.toUpperCase();var d=null;t.children&&(d=t.children[l+"."+o[0]],("undefined"==typeof d||null==d)&&(d=t.children[l+"."+o[0]+"."+t.uidValue])),i=null!=d&&null!=d.jbo?d.jbo.datas[o[1]]:""}else i=t.datas[n];if(null!=i&&void 0!=i&&i&&(i.toString().indexOf("GMT")>0||i.toString().indexOf("UTC")>0)){var c=$(this).attr("class");if(c&&void 0!=c){var s="";c.indexOf("custom['date']")>=0?s="date":c.indexOf("custom[dateTime]")>=0&&(s="dateTime"),i=JxUtil.formatDate(i.toString(),s)}}if(void 0!=i&&null!=i&&"null"!==i&&("undefined"==typeof $(this).closest("table").attr("relationship")||"TABLE"==a)){var u=$(this).attr("format");u&&u.length>0&&""!=i&&(i=accounting.formatMoney(i)),"LABEL"==r?$(this).text(i):"checkbox"==$(this).attr("type")?("1"==i||1==i?$(this).attr("checked","checked"):$(this).removeAttr("checked"),$(this).val(i)):"SELECT"==r||$(this).val(i)}}})}function dhtmlxGantt(e){var t=$(e).attr("columns");"TSEP"==t?(gantt.config.columns=[{name:"text",label:"任务",tree:!0,width:"*"},{name:"start_date",label:"开始时间",align:"right",width:"70"},{name:"end_date",label:"结束时间",align:"right",width:"70"},{name:"progress",label:"完成进度",align:"right",width:"40"}],gantt.config.grid_width=500):"TSE"==t?gantt.config.columns=[{name:"text",label:"任务",tree:!0,width:"*"},{name:"start_date",label:"开始时间",align:"right",width:"70"},{name:"end_date",label:"结束时间",align:"right",width:"70"}]:"TE"==t?gantt.config.columns=[{name:"text",label:"任务",tree:!0,width:"*"},{name:"end_date",label:"结束时间",align:"right",width:"70"}]:"NONE"==t?(gantt.config.columns=[],gantt.config.grid_width=2):gantt.config.columns=[{name:"text",label:"任务",tree:!0,width:"*"}];var a=$(e).attr("dReadonly");"true"==a&&(gantt.config.readonly=!0,gantt.config.drag_lightbox=!1,gantt.attachEvent("onBeforeLightbox",function(){return!1}));var n=$(e).attr("scale");if("year"==n)gantt.config.scale_unit="year",gantt.config.step=1,gantt.config.scale_height=50,gantt.config.subscales=[{unit:"year",step:1,date:"%Y"}];else if("month"==n)gantt.config.scale_unit="month",gantt.config.step=1,gantt.config.scale_height=50,gantt.config.subscales=[{unit:"year",step:1,date:"%Y"}];else if("week"==n)gantt.config.scale_unit="week",gantt.config.step=1,gantt.config.scale_height=80,gantt.config.subscales=[{unit:"month",step:1,date:"%M"},{unit:"year",step:1,date:"%Y"}];else if("day"==n){gantt.config.scale_unit="month",gantt.config.step=1,gantt.config.scale_height=80,gantt.config.date_scale="%Y年%F";var r=function(e){var t=gantt.date.date_to_str("%d %M"),a=gantt.date.add(gantt.date.add(e,1,"week"),-1,"day");return t(e)+" - "+t(a)};gantt.config.subscales=[{unit:"week",step:1,template:r},{unit:"day",step:1,date:"%D"}]}var i=$(e).attr("id");gantt.config.fit_tasks=!0,gantt.config.api_date="%Y-%n-%d",gantt.config.date_grid="%Y-%n-%d",gantt.config.sort=!0;var i=$(e).attr("id");gantt.init(i)}function openTreeTable(e){var t=$(e).closest("tr"),a=$(e).closest("table[rootparent!='']"),n=-1;if(t){if(n=t.attr("uid"),!a||0>n)return;if("close"!=$("td:first span",t).attr("treeStatus"))return void closeTreeTable(t);$("td:first span",t).attr("treeStatus","open"),$("td:first span",t).removeClass("treeclose").addClass("treeopen")}var r=a.attr("jboname"),i=a.attr("rootparent"),o=i.split(":");WebClientBean.getJboListByCause(r,o[0]+"=?",n,{callback:function(a){if(null!=a){if(0==a.length)return $(e).removeClass("treeopen").addClass("treechild"),void $(e).removeAttr("onclick");for(var r=0,i=a.length;i>r;i--){var o=a[i-1],l=t.clone();l.attr("uid",o.uidValue).attr("pid",n),$("td:first span",l).removeClass("treeopen").addClass("treeclose").attr("treeStatus","close");var d=$("td:first span",t).css("margin-left").replace("px","");$("td:first span",l).css("margin-left",parseInt(d)+20),setData(l,o,"TABLE"),l.insertAfter(t)}}},errorHandler:errorHandler,exceptionHandler:exceptionHandler})}function closeTreeTable(e){var t=$(e).closest("table"),a=$(e).attr("uid"),n=$("tr[pid='"+a+"']",t),r=n.length;if(r>0){$("td:first span",e).attr("treeStatus","close"),$("td:first span",e).removeClass("treeopen").addClass("treeclose");for(var i=0;r>i;i++)closeTreeTable(n[i]),$(n[i]).remove()}else $(e).remove()}function selectTableTr(e,t){if(t=$.event.fix(t||window.event),!t.target.nodeName.toUpperCase().match(/^(a|input)$/i)){var a=$(e),n=a.closest(".fragment-mode"),r=a.find("input:checkbox");if(r.length){var i=$("input[type='checkbox'][name='allbox']",n);i&&i.length>0&&$("tr[class='trSelected']",table).removeClass("trSelected");var o=r[0].checked;r.prop("checked",!o),ckOneSelectHandler(r[0],r.attr("index"))}a.toggleClass("trSelected")}}function excuteJboSetMethod(e,t,a,n,r,i){return""==e||void 0==e||null==e?(alert("请配置jboname"),!1):((""==t||void 0==t||null==t)&&alert("请配置jbo method"),void WebClientBean.excuteJboSetMethod(e,t,a,{callback:function(e){"true"==e?""!=r&&msgTip(r,""):"false"==e?""!=n&&msgTip(n,""):msgTip(e,""),null!=i&&i(e)},errorHandler:errorHandler,exceptionHandler:exceptionHandler}))}function getJboSetMethodReturnValue(e,t,a){if(""==e||void 0==e||null==e)return alert("请配置jboname"),!1;(""==t||void 0==t||null==t)&&alert("请配置jbo method"),dwr.engine.setAsync(!1);var n="";return WebClientBean.excuteJboSetMethod(e,t,a,{callback:function(e){n=e},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0),n}function showDashboardLet(e){var t=$(e).attr("href"),a=$(e).attr("target");windowopen(t,a)}function windowopen(e,t){var a=document.createElement("a");a.id="gg"+parseInt(100*Math.random()),a.target=t,a.href=e,document.body.appendChild(a),a.click(),document.body.removeChild(a)}function getMainAppAttributeValue(e){dwr.engine.setAsync(!1);var t="";return WebClientBean.getData(function(a){for(var n in a)a.hasOwnProperty(n)&&n==e&&(t=a[n])}),dwr.engine.setAsync(!0),t}function importFile(e,t){var a=$(e).attr("relationship"),n=$(e).attr("fragmentid");(null==a||void 0==a)&&(a=$("#"+n).attr("relationship"));var r="app.action?relationship="+(void 0==a?"":a)+"&appNameType="+jx_appNameType;appDialog("impfile","impfile","impfile",r,"auto",200,function(){getTableData("div_"+n.toLowerCase(),t,null)})}function tabCreate(){}function beforeActivate(){}function beforeLoad(){}function tabActivate(){}function beforeTabLoad(e,t){t.panel.html("load... "),t.jqXHR.error(function(){t.panel.html("Couldn't load this tab. ")})}function tabLoaded(){}function getAttachFileSize(e,t,a){dwr.engine.setAsync(!1);var n="";return WebClientBean.getAttachmentFileSize(e,t,a,{callback:function(e){n=e},errorHandler:errorHandler,exceptionHandler:exceptionHandler}),dwr.engine.setAsync(!0),n}function sessionTimeout(e){alert(getLangString("jxcommon.sessionTimeout")),window&&(window.top.location.href=e+"/loginAction.do")}function inputQueryParams(e,t,a){WebClientBean.inputQueryOnBlur(jx_appNameType,"",e,t,{callback:function(){null!=a&&a()},errorHandler:errorHandler,exceptionHandler:exceptionHandler})}function initUILang(){}function showToolbarMsg(e){if(e.length>0){var t=$("#appMsg");0==t.length&&(t=$("#appMsg",parent.document)),t&&t.length>0?(t.text(e).show(),setTimeout(function(){t.hide().text("")},2e3)):alert(e)}}function logout(){parent.window.location.href="/jxweb/login/logout.jsp"}function afterTreeInit(){}function refresh(){location.reload()}function refreshAttlist(e){var t=document.getElementById("iframeAtt_"+e).src;$("iframeAtt_"+e).attr("src",$("iframeAtt_"+e).attr("src")),document.getElementById("iframeAtt_"+e).src=t}function resetIframeHeight(e){var t=$("iframe[name^='iframeAtt_']",parent.document);$.each(t,function(t,a){var n=$(a).contents().find("div[id='"+e+"']");if(n.length>0){var r=a;r&&!window.opera&&(r.contentDocument&&r.contentDocument.body.offsetHeight?r.height=r.contentDocument.body.offsetHeight:r.Document&&r.document.body.scrollHeight&&(r.height=r.document.body.clientHeight))}})}function isNull(e){return null==e?!0:0==e.length?!0:!1}function isBlank(e){if(null==e)return!0;for(var t=0;t<e.length;t++)if(" "!=e.charAt(t)&&"	"!=e.charAt(t)&&"\n"!=e.charAt(t))return!1;return!0}function isDigit(e){if(null!=e||1==e.length){var t="1234567890";if(-1!=t.indexOf(e))return!0}return!1}function isInteger(e){for(var t=0;t<e.length;t++)if(!isDigit(e.charAt(t)))return!1;return!0}function isNumeric(e){for(var t=!1,a=0;a<e.length;a++)if(!isDigit(e.charAt(a))){if("."!=e.charAt(a))return!1;if(1==t)return!1;if(t=!0,"-"==e.charAt(a))return!1}return!0}function initSql(e){$(e).attr("disabled","true"),$("#result").show(),$("#result").html(getLangString("jxcommon.wait"));var t=$(e).attr("url");(""==t||void 0==t)&&(t="config_sqlInstall.action?"+window.location.search);var a=$(e).attr("filename");(null==a||void 0==a)&&(a=$("#fileName").val());var n=$(e).attr("msgid");(""==n||void 0==n)&&(n="result"),$.ajax({type:"GET",url:t,data:{fileName:a},dataType:"html",cache:!1,success:function(t){$("#"+n).html(t),$("#"+n).show(),prettyPrint(),$(e).removeAttr("disabled")},error:function(t,a,r){$("#"+n).html(t+","+a+","+r),$("#"+n).show(),prettyPrint(),$(e).removeAttr("disabled")}})}function AmountInWords(e,t){if(e=e.toString().replace(/,/g,""),e=e.replace(/^0+/,""),""==e)return"零元整";if(isNaN(e))return"错误：金额不是合法的数值！";var a="",n="";e.length>1&&(0==e.indexOf("-")&&(e=e.replace("-",""),a="负"),0==e.indexOf("+")&&(e=e.replace("+","")));var r,i,o,l,d,c,s,u,p,g,m,f,h="",v="",$="undefined"==typeof t||null==t||Number(t)<0||Number(t)>5;if(i=e.split("."),i.length>1){h=i[0],v=i[1],$&&(t=v.length>5?5:v.length);var b=Number("0."+v);b*=Math.pow(10,t),b=Math.round(Math.abs(b)),b/=Math.pow(10,t);var x=b.toString().split(".");1==Number(x[0])&&(h=(Number(h)+1).toString()),v=x.length>1?x[1]:""}else h=e,v="",$&&(t=0);if(h.length>44)return"错误：金额值太大了！整数位长【"+h.length.toString()+"】超过了上限——44位/千正/10^43（注：1正=1万涧=1亿亿亿亿亿，10^40）！";if(o=new Array("零","壹","贰","叁","肆","伍","陆","柒","捌","玖"),l=new Array("","拾","佰","仟"),d=new Array("","万","亿","兆","京","垓","杼","穰","沟","涧","正"),c=new Array("角","分","厘","毫","丝"),r="",Number(h)>0){for(s=0,u=0;u<h.length;u++)p=h.length-u-1,g=h.substr(u,1),m=p/4,f=p%4,"0"==g?s++:(s>0&&(r+=o[0]),s=0,r+=o[Number(g)]+l[f]),0==f&&4>s&&(r+=d[m]);r+="元"}for(u=0;u<v.length;u++)g=v.substr(u,1),"0"!=g&&(r+=o[Number(g)]+c[u]);return""==r&&(r="零元"),""==v&&(r+="整"),r=n+a+r}function DateAdd(e,t,a){switch(e){case"y":return a.setFullYear(a.getFullYear()+t),a;case"q":return a.setMonth(a.getMonth()+3*t),a;case"m":return a.setMonth(a.getMonth()+t),a;case"w":return a.setDate(a.getDate()+7*t),a;case"d":return a.setDate(a.getDate()+t),a;case"h":return a.setHours(a.getHours()+t),a;case"m":return a.setMinutes(a.getMinutes()+t),a;case"s":return a.setSeconds(a.getSeconds()+t),a;default:return a.setDate(d.getDate()+t),a}}function select2AjaxSelectTag(e,t,a,n,r,o,l){var d=$("#"+e),c=(t||a||"").toLowerCase(),s={};n=(n||"description").toLowerCase(),r=r.replace(/['"]/g,"");var u=function(e){if(e.loading)return e.text;var t=e[c]+"-"+e[n];return t},p=function(e){return e[n]};s[c]=-1,s.id=-1,s[n]=l,d.select2({placeholder:s,allowClear:!0,ajax:{url:r,dataType:"json",delay:250,data:function(e){return{quickSearchCause:e.term,render:"json",jsonhead:'[{"total_count":"count"},{"fixText":"\\"items\\":"}]',startStr:"{",endStr:"}"}},processResults:function(e,t){t.page=t.page||1;var a=e.items,n=a.length;if(n>0&&void 0==a[0].id)for(i=0;n>i;i++)a[i].id=a[i][c];return{results:e.items,pagination:{more:20*t.page<e.total_count}}},cache:!0},initSelection:function(e,t){var a={},r=d.find("option:selected");a[c]=r.val(),a.id=r.val(),a[n]=r.text(),t(a)},escapeMarkup:function(e){return e},minimumInputLength:1,templateResult:u,templateSelection:p})}function select2CustomSelectTag(e,t,a){$("#"+e).select2({placeholder:t||"Select an option",allowClear:a})}function initAccountingPlugin(){window.accounting=window.accounting||{},accounting.settings={currency:{symbol:"￥",format:"%s%v",decimal:".",thousand:",",precision:2},number:{precision:0,thousand:",",decimal:"."}}}function executActionMethod(me,e){var actionurl=$(me).attr("url");if(void 0!=actionurl&&""!=actionurl&&"true"!=$(me).attr("disabled")){$(me).attr("disabled","true");var msgid=$(me).attr("msgid");void 0!=msgid&&""!=msgid&&$("#"+msgid).hide();var callback=$(me).attr("callback");$.ajax({type:"POST",url:actionurl,dataType:"html",data:$("*").serialize(),cache:!1,success:function(data,textStatus){if(void 0!=msgid&&""!=msgid&&""!=data&&($("#"+msgid).show(),$("#"+msgid).html(data)),void 0!=callback&&""!=callback)try{eval(callback)}catch(exception){}$(me).removeAttr("disabled")},error:function(e,t,a){void 0!=msgid&&""!=msgid&&($("#"+msgid).show(),$("#"+msgid).html(e+","+t+","+a)),$(me).removeAttr("disabled")}})}}function executeaction(e,t){executActionMethod(e,t)}function setRequiredOrNot(e,t,a){var n=$(e),r=function(){n.parent().prev().attr("class","form_td_label required"),n.parent().children().each(function(e,t){$(t).show()})},i=function(){n.removeAttr("readonly"),n.attr("required","required")},o=function(){n.attr("readonly","readonly"),n.removeAttr("required")};if(t)if("select"==a){n.parent().parent().prev().attr("class","form_td_label required"),n.removeAttr("disabled");var l=n.attr("selectclass");"undefined"!=typeof l&&n.attr("class",l),i(e)}else if("date"==a){r(e);var d=n.attr("dateclass");"undefined"!=typeof d&&n.attr("class",d),i(e)}else if("lookup"==a){var c=$("#"+(n.attr("id")+"_DESC"));n.parent().children().each(function(e,t){$(t).attr("id")!=c.attr("id")&&$(t).show()});var s=c.attr("lookupclass");"undefined"!=typeof s&&(c.attr("lookupclass",s),c.attr("class",s)),n.removeAttr("readonly"),n.removeAttr("style"),n.parent().parent().find(".form_td_label").addClass("required")}else{r(e);var u=n.attr("oldclass");"undefined"!=typeof u&&n.attr("class",u),i(e)}else if("select"==a)n.parent().parent().prev().attr("class","form_td_label"),n.attr("selectclass",n.attr("class")),n.attr("disabled","disabled"),o(e),n.removeAttr("class");else if("date"==a){n.parent().prev().attr("class","form_td_label"),n.parent().children().each(function(e,t){$(t).attr("id")!=n.attr("id")&&$(t).hide()});var d=n.attr("dateclass");"undefined"==typeof d&&n.attr("dateclass",n.attr("class")),o(e),n.attr("class","form_td_100")}else if("lookup"==a){var c=$("#"+(n.attr("id")+"_DESC"));n.parent().prev().attr("class","form_td_label"),n.parent().children().each(function(e,t){$(t).attr("id")!=c.attr("id")&&$(t).hide()});var s=c.attr("lookupclass");"undefined"==typeof s&&c.attr("lookupclass",c.attr("class")),o(c),c.attr("class","form_td_multipart_readonly")}else{n.parent().prev().attr("class","form_td_label"),n.parent().children().each(function(e,t){$(t).attr("id")!=n.attr("id")&&$(t).hide()});var u=n.attr("oldclass");"undefined"==typeof u&&n.attr("oldclass",n.attr("class")),n.attr("class","form_td_100"),o(e)}}function setChildTableReadOnly(e){var t=$("tbody tr",e),a=$("thead tr",e);a.length>0&&($("thead>tr:first",e).hide(),$("thead>tr:first",e).next().hide()),t.length>0&&($("input",e).each(function(){var e=$(this).closest("td").attr("useful"),t=$(this).attr("type");if("checkbox"==t)$(this).attr("disabled","disabled");else if("undefined"==typeof e){$(this).closest("td").children().hide();var a=$(this).val();$(this).closest("td").append("<span title='"+a+"'>"+a+"</span>")}}),$("thead>tr>th",e).each(function(){var e=$(this).attr("dataattribute");(void 0==e||""==e)&&$(this).hide()}),$("tbody>tr>td",e).each(function(){var e=$(this).attr("dataattribute"),t=$("select",$(this));(void 0==e||""==e)&&(t&&t.length>0||$(this).hide())}))}function createLayout(e){var t=$("#"+e),a=getLayoutOptions(t);a.applyDemoStyles=!1,t.layout(a)}function getLayoutOptions(e){var t={};return e.find(">.ui-layout-pane").each(function(){var e=$(this),a=e.attr("region");t[a]={},"center"!=a&&(e.attr("size")&&(t[a].size=e.attr("size")),e.attr("minSize")&&(t[a].minSize=e.attr("minSize")),e.attr("maxSize")&&(t[a].maxSize=e.attr("maxSize")),t[a].resizable=!("false"==e.attr("resizable")),t[a].closable=!("false"==e.attr("closable")),t[a].spacing_open=parseInt(e.attr("space")),"close"==e.attr("status")?t[a].initClosed=!0:"hidden"==e.attr("status")&&(t[a].initHidden=!0))}),t}function resizeLayout(e,t){var a=e.find(".ui-layout-container.panel").data("layout");a&&($.isFunction(t)&&t(),a.resizeAll())}function loadingMask(e,t){t?e.mask({element:'<div class="loading-mask float-loading-mask"><span class="loading"></span></div>'}):e.html('<div class="loading-mask empty-loading-mask"><span class="loading"></span></div>')}function loadingUnmask(e){var t=e.find(".loading-mask");t.is(".empty-loading-mask")?t.remove():e.unmask()}function processTreeNode(e){return e}var sUserAgent=navigator.userAgent.toLowerCase(),bIsIpad="ipad"==sUserAgent.match(/ipad/i),bIsIphoneOs="iphone os"==sUserAgent.match(/iphone os/i),bIsMidp="midp"==sUserAgent.match(/midp/i),bIsUc7="rv:1.2.3.4"==sUserAgent.match(/rv:1.2.3.4/i),bIsUc="ucweb"==sUserAgent.match(/ucweb/i),bIsAndroid="android"==sUserAgent.match(/android/i),bIsCE="windows ce"==sUserAgent.match(/windows ce/i),bIsWM="windows mobile"==sUserAgent.match(/windows mobile/i),bIsIE="msie"==sUserAgent.match(/msie/i),bIsChrome="chrome"==sUserAgent.match(/chrome/i),bIsFireFox="firefox"==sUserAgent.match(/firefox/i),JxUtil={extend:function(e,t,a){return a?function(){e.apply(this,arguments),t.apply(this,arguments)}:function(){t.apply(this,arguments)}},formatDate:function(e,t){e+="";var a="",n={};n.Jan="01",n.Feb="02",n.Mar="03",n.Apr="04",n.May="05",n.Jun="06",n.Jul="07",n.Aug="08",n.Sep="09",n.Oct="10",n.Nov="11",n.Dec="12";var r={};r.Mon="一",r.Tue="二",r.Wed="三",r.Thu="四",r.Fri="五",r.Sat="六",r.Sun="日";var i=e.split(" ");return e.indexOf("GMT")>0?(a=i[3]+"-",a=a+n[i[1]]+"-"+i[2],"dateTime"==t&&(a+=" "+i[4])):e.indexOf("UTC")>0&&(a=i[5]+"-",a=a+n[i[1]]+"-"+i[2],"dateTime"==t&&(a+=" "+i[3])),a},getClientWidth:function(){var e=0;return e=document.body.clientWidth&&document.documentElement.clientWidth?document.body.clientWidth<document.documentElement.clientWidth?document.body.clientWidth:document.documentElement.clientWidth:document.body.clientWidth>document.documentElement.clientWidth?document.body.clientWidth:document.documentElement.clientWidth},getClientHeight:function(){var e=0;return e=document.body.clientHeight&&document.documentElement.clientHeight?document.body.clientHeight<document.documentElement.clientHeight?document.body.clientHeight:document.documentElement.clientHeight:document.body.clientHeight>document.documentElement.clientHeight?document.body.clientHeight:document.documentElement.clientHeight},getScroll:function(e){if(e&&e.length>1)return void debug("只能对指定的单一元素进行判断");var t=$(e),a=!1,n=!1;return t.is("html")||t.is("body")?(a=$("body")[0].scrollWidth>$(window).width(),n=$("body")[0].scrollHeight>$(window).height()):(a=e.scrollWidth>e.clientWidth,n=e.scrollHeight>e.clientHeight),{scrollX:a,scrollY:n}},getByteLen:function(e){e=e.replace(/\./g,"").replace(/\,/g,"");for(var t=0,a=0;a<e.length;a++)t+=null!=e[a].match(/[^\x00-\xff]/gi)?2:1;return t},getByteVal:function(e,t){e=e.replace(/\./g,"").replace(/\,/g,"");for(var a="",n=0,r=0;r<e.length&&(n+=null!=e[r].match(/[^\x00-\xff]/gi)?2:1,!(n>t));r++)a+=e[r];return a},isTopWindow:function(){return window.top==window.self},adjustNumToFixString:function(e,t){var a;if(e=e.toString(),e.length>t)return a=new RegExp("\\d{"+t+"}$"),e.match(a)[0];if(e.length==t)return e;for(var n=t-e.length,r="",i=0;n>i;i++)r+="0";return r+e},isExpandContext:!1,expandSourceRow:null};String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")},String.prototype.ltrim=function(){return this.replace(/(^\s*)/g,"")},String.prototype.rtrim=function(){return this.replace(/(\s*$)/g,"")};var tabUtil={getTabGroup:function(e){return $("#"+e).tabs()},getSelectedTabIndex:function(e){return this.getTabGroup(e).tabs("option","active")},getSelectedTabLink:function(e){return $(".ui-tabs-active a","#"+e)},loadTab:function(e,t,a){var n=this.getSelectedTabLink(e).attr("href");this.getSelectedTabLink(e).attr("href",a),this.getTabGroup(e).data("loaded",!1),this.getTabGroup(e).tabs("load",t),this.getSelectedTabLink(e).attr("href",n)
},changeTab:function(e,t,a){var n=$($("a[class='ui-tabs-anchor']",$("#"+e))[t]),r=n.attr("href");n.attr("href",a),this.getTabGroup(e).tabs("option","active",t),this.getTabGroup(e).tabs("refresh"),n.attr("href",r)}};$(function(){var e=getUrlParam("uid"),t=getUrlParam("flag");(e&&e>0||""!=e)&&$(".appbar-menu").html(""),t&&""!=t&&$(".appbar-menu").html(""),$(".toolbar_btn").on("mouseenter",function(){var e=$(this).find("img")[0];e&&(e.src=e.src.replace(".png","_hover.png"))}).on("mouseleave",function(){var e=$(this).find("img")[0];e&&(e.src=e.src.replace("_hover.png",".png"))})}),function(){initAccountingPlugin(),$.extend($.fn,{mask:function(e,t,a){this.unmask();var n={opacity:.8,z:1e4,bgcolor:"#ccc"},r=$(document.body),i={top:0,left:0};this[0]&&this[0]!==window.document&&(r=this,i=r.position());var o=$('<div id="maskdivgen" class="maskdivgen">&nbsp;</div>'),l=r.outerWidth();l||(l=r.width());var d=r.outerHeight();if(d||(d=r.height()),o.css({position:"absolute",top:i.top,left:i.left,"z-index":n.z,width:l,height:d,"background-color":n.bgcolor,opacity:0}),o.appendTo(r),$(window).resize(function(){var e=$("#maskdivgen"),t=r.outerWidth();t||(t=r.width());var a=r.outerHeight();a||(a=r.height()),e.css({height:a+"px",width:t+"px"});var n=$("#msgDiv"),i=e.width()-n.width(),o=$(document).scrollTop(),l=window.screen.availHeight;n.css({left:i/2+"px",top:l/2+o-150+"px"})}),$(window).scroll(function(){var e=$("#maskdivgen"),t=$("#msgDiv"),a=e.width()-t.width(),n=$(document).scrollTop(),r=window.screen.availHeight;t.css({left:a/2+"px",top:r/2+n-150+"px"})}),t&&o.addClass(t),e){var c="[object String]"===Object.prototype.toString.call(e);if(c){var s=$('<div id="msgDiv"><div style="line-height:24px;border:#a3bad9 1px solid;background:white;padding:2px 10px 2px 10px">'+e+"</div></div>");s.css({position:"absolute",border:"#6593cf 1px solid",padding:"2px;background:#ccca"}),s.appendTo(o);{var u=o.width()-s.width(),p=$(document).scrollTop(),g=window.screen.availHeight;o.height()-s.height()}s.css({cursor:"wait",top:g/2+p-150,left:u/2})}else if(e.element){var s=$(e.element);o.html(s)}else{var s=$('<div id="msgDiv"></div>');s.css({position:"absolute",border:"#6593cf 1px solid",padding:"2px;background:#ccca"}),e.appendTo(s),s.appendTo(o);{var u=o.width()-s.width(),p=$(document).scrollTop(),g=window.screen.availHeight;o.height()-s.height()}s.css({cursor:"wait",top:g/2+p-150,left:u/2})}}o.fadeIn("fast",function(){jQuery.isFunction(a)?$(this).fadeTo("slow",n.opacity,a):$(this).fadeTo("slow",n.opacity)})},unmask:function(){var e=$(document.body);this[0]&&this[0]!==window.document&&(e=$(this[0])),e.find("> div.maskdivgen").fadeOut("slow",0,function(){$(this).remove()})},queueMask:function(e,t){$(this).mask(e[0]);for(var a=$("#msgDiv").find("div").width(140),n=[],r=0;r<e.length;r++)!function(r){n.push(function(){a.html(e[r]),setTimeout(function(){r==e.length-1&&a.queue("mx",n),a.dequeue("mx")},t)})}(r);a.queue("mx",n),a.dequeue("mx")},dequeueMask:function(){$("#msgDiv").find("div").queue("mx",[]),$(this).unmask()}})}(),$(function(){$("body").keydown(function(e){var t=$("span[mxevent='searchOk']");0!=t.length&&t.is(":visible")&&"13"==e.keyCode&&($(":focus").blur(),t.click())})});