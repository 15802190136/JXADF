!function(p){var G,H,I,J,K,L,r={},u={},v={},M={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0},data:{key:{children:"children",name:"name",title:"",url:"url"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},w=[function(t){var n=t.treeObj,a=e.event;n.bind(a.NODECREATED,function(e,n,a){j.apply(t.callback.onNodeCreated,[e,n,a])}),n.bind(a.CLICK,function(e,n,a,o,r){j.apply(t.callback.onClick,[n,a,o,r])}),n.bind(a.EXPAND,function(e,n,a){j.apply(t.callback.onExpand,[e,n,a])}),n.bind(a.COLLAPSE,function(e,n,a){j.apply(t.callback.onCollapse,[e,n,a])}),n.bind(a.ASYNC_SUCCESS,function(e,n,a,o){j.apply(t.callback.onAsyncSuccess,[e,n,a,o])}),n.bind(a.ASYNC_ERROR,function(e,n,a,o,r,i){j.apply(t.callback.onAsyncError,[e,n,a,o,r,i])})}],x=[function(t){var n=e.event;t.treeObj.unbind(n.NODECREATED).unbind(n.CLICK).unbind(n.EXPAND).unbind(n.COLLAPSE).unbind(n.ASYNC_SUCCESS).unbind(n.ASYNC_ERROR)}],y=[function(e){var t=h.getCache(e);t||(t={},h.setCache(e,t)),t.nodes=[],t.doms=[]}],z=[function(e,t,n,a,o,r){if(n){var i=h.getRoot(e),l=e.data.key.children;n.level=t,n.tId=e.treeId+"_"+ ++i.zId,n.parentTId=a?a.tId:null,n[l]&&n[l].length>0?("string"==typeof n.open&&(n.open=j.eqs(n.open,"true")),n.open=!!n.open,n.isParent=!0,n.zAsync=!0):(n.open=!1,"string"==typeof n.isParent&&(n.isParent=j.eqs(n.isParent,"true")),n.isParent=!!n.isParent,n.zAsync=!n.isParent),n.isFirstNode=o,n.isLastNode=r,n.getParentNode=function(){return h.getNodeCache(e,n.parentTId)},n.getPreNode=function(){return h.getPreNode(e,n)},n.getNextNode=function(){return h.getNextNode(e,n)},n.isAjaxing=!1,h.fixPIdKeyValue(e,n)}}],s=[function(t){var n=t.target,a=h.getSetting(t.data.treeId),o="",r=null,i="",l="",d=null,s=null,c=null;if(j.eqs(t.type,"mousedown")?l="mousedown":j.eqs(t.type,"mouseup")?l="mouseup":j.eqs(t.type,"contextmenu")?l="contextmenu":j.eqs(t.type,"click")?j.eqs(n.tagName,"span")&&null!==n.getAttribute("treeNode"+e.id.SWITCH)?(o=j.getNodeMainDom(n).id,i="switchNode"):(c=j.getMDom(a,n,[{tagName:"a",attrName:"treeNode"+e.id.A}]))&&(o=j.getNodeMainDom(c).id,i="clickNode"):j.eqs(t.type,"dblclick")&&(l="dblclick",c=j.getMDom(a,n,[{tagName:"a",attrName:"treeNode"+e.id.A}]))&&(o=j.getNodeMainDom(c).id,i="switchNode"),l.length>0&&0==o.length&&(c=j.getMDom(a,n,[{tagName:"a",attrName:"treeNode"+e.id.A}]))&&(o=j.getNodeMainDom(c).id),o.length>0)switch(r=h.getNodeCache(a,o),i){case"switchNode":r.isParent&&(j.eqs(t.type,"click")||j.eqs(t.type,"dblclick")&&j.apply(a.view.dblClickExpand,[a.treeId,r],a.view.dblClickExpand))?d=G:i="";break;case"clickNode":d=H}switch(l){case"mousedown":s=I;break;case"mouseup":s=J;break;case"dblclick":s=K;break;case"contextmenu":s=L}return{stop:!1,node:r,nodeEventType:i,nodeEventCallback:d,treeEventType:l,treeEventCallback:s}}],A=[function(e){var t=h.getRoot(e);t||(t={},h.setRoot(e,t)),t[e.data.key.children]=[],t.expandTriggerFlag=!1,t.curSelectedList=[],t.noSelection=!0,t.createdNodes=[],t.zId=0,t._ver=(new Date).getTime()}],B=[],C=[],D=[],E=[],F=[],h={addNodeCache:function(e,t){h.getCache(e).nodes[h.getNodeCacheId(t.tId)]=t},getNodeCacheId:function(e){return e.substring(e.lastIndexOf("_")+1)},addAfterA:function(e){C.push(e)},addBeforeA:function(e){B.push(e)},addInnerAfterA:function(e){E.push(e)},addInnerBeforeA:function(e){D.push(e)},addInitBind:function(e){w.push(e)},addInitUnBind:function(e){x.push(e)},addInitCache:function(e){y.push(e)},addInitNode:function(e){z.push(e)},addInitProxy:function(e,t){t?s.splice(0,0,e):s.push(e)},addInitRoot:function(e){A.push(e)},addNodesData:function(e,t,n){var a=e.data.key.children;t[a]||(t[a]=[]),t[a].length>0&&(t[a][t[a].length-1].isLastNode=!1,i.setNodeLineIcos(e,t[a][t[a].length-1])),t.isParent=!0,t[a]=t[a].concat(n)},addSelectedNode:function(e,t){var n=h.getRoot(e);h.isSelectedNode(e,t)||n.curSelectedList.push(t)},addCreatedNode:function(e,t){(e.callback.onNodeCreated||e.view.addDiyDom)&&h.getRoot(e).createdNodes.push(t)},addZTreeTools:function(e){F.push(e)},exSetting:function(e){p.extend(!0,M,e)},fixPIdKeyValue:function(e,t){e.data.simpleData.enable&&(t[e.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[e.data.simpleData.idKey]:e.data.simpleData.rootPId)},getAfterA:function(){for(var e=0,t=C.length;t>e;e++)C[e].apply(this,arguments)},getBeforeA:function(){for(var e=0,t=B.length;t>e;e++)B[e].apply(this,arguments)},getInnerAfterA:function(){for(var e=0,t=E.length;t>e;e++)E[e].apply(this,arguments)},getInnerBeforeA:function(){for(var e=0,t=D.length;t>e;e++)D[e].apply(this,arguments)},getCache:function(e){return v[e.treeId]},getNextNode:function(e,t){if(!t)return null;for(var n=e.data.key.children,a=t.parentTId?t.getParentNode():h.getRoot(e),o=0,r=a[n].length-1;r>=o;o++)if(a[n][o]===t)return o==r?null:a[n][o+1];return null},getNodeByParam:function(e,t,n,a){if(!t||!n)return null;for(var o=e.data.key.children,r=0,i=t.length;i>r;r++){if(t[r][n]==a)return t[r];var l=h.getNodeByParam(e,t[r][o],n,a);if(l)return l}return null},getNodeCache:function(e,t){if(!t)return null;var n=v[e.treeId].nodes[h.getNodeCacheId(t)];return n?n:null},getNodeName:function(e,t){return""+t[e.data.key.name]},getNodeTitle:function(e,t){return""+t[""===e.data.key.title?e.data.key.name:e.data.key.title]},getNodes:function(e){return h.getRoot(e)[e.data.key.children]},getNodesByParam:function(e,t,n,a){if(!t||!n)return[];for(var o=e.data.key.children,r=[],i=0,l=t.length;l>i;i++)t[i][n]==a&&r.push(t[i]),r=r.concat(h.getNodesByParam(e,t[i][o],n,a));return r},getNodesByParamFuzzy:function(e,t,n,a){if(!t||!n)return[];for(var o=e.data.key.children,r=[],a=a.toLowerCase(),i=0,l=t.length;l>i;i++)"string"==typeof t[i][n]&&t[i][n].toLowerCase().indexOf(a)>-1&&r.push(t[i]),r=r.concat(h.getNodesByParamFuzzy(e,t[i][o],n,a));return r},getNodesByFilter:function(e,t,n,a,o){if(!t)return a?null:[];for(var r=e.data.key.children,i=a?null:[],l=0,d=t.length;d>l;l++){if(j.apply(n,[t[l],o],!1)){if(a)return t[l];i.push(t[l])}var s=h.getNodesByFilter(e,t[l][r],n,a,o);if(a&&s)return s;i=a?s:i.concat(s)}return i},getPreNode:function(e,t){if(!t)return null;for(var n=e.data.key.children,a=t.parentTId?t.getParentNode():h.getRoot(e),o=0,r=a[n].length;r>o;o++)if(a[n][o]===t)return 0==o?null:a[n][o-1];return null},getRoot:function(e){return e?u[e.treeId]:null},getRoots:function(){return u},getSetting:function(e){return r[e]},getSettings:function(){return r},getZTreeTools:function(e){return(e=this.getRoot(this.getSetting(e)))?e.treeTools:null},initCache:function(){for(var e=0,t=y.length;t>e;e++)y[e].apply(this,arguments)},initNode:function(){for(var e=0,t=z.length;t>e;e++)z[e].apply(this,arguments)},initRoot:function(){for(var e=0,t=A.length;t>e;e++)A[e].apply(this,arguments)},isSelectedNode:function(e,t){for(var n=h.getRoot(e),a=0,o=n.curSelectedList.length;o>a;a++)if(t===n.curSelectedList[a])return!0;return!1},removeNodeCache:function(e,t){var n=e.data.key.children;if(t[n])for(var a=0,o=t[n].length;o>a;a++)arguments.callee(e,t[n][a]);h.getCache(e).nodes[h.getNodeCacheId(t.tId)]=null},removeSelectedNode:function(e,t){for(var n=h.getRoot(e),a=0,o=n.curSelectedList.length;o>a;a++)t!==n.curSelectedList[a]&&h.getNodeCache(e,n.curSelectedList[a].tId)||(n.curSelectedList.splice(a,1),a--,o--)},setCache:function(e,t){v[e.treeId]=t},setRoot:function(e,t){u[e.treeId]=t},setZTreeTools:function(){for(var e=0,t=F.length;t>e;e++)F[e].apply(this,arguments)},transformToArrayFormat:function(e,t){if(!t)return[];var n=e.data.key.children,a=[];if(j.isArray(t))for(var o=0,r=t.length;r>o;o++)a.push(t[o]),t[o][n]&&(a=a.concat(h.transformToArrayFormat(e,t[o][n])));else a.push(t),t[n]&&(a=a.concat(h.transformToArrayFormat(e,t[n])));return a},transformTozTreeFormat:function(e,t){var n,a,o=e.data.simpleData.idKey,r=e.data.simpleData.pIdKey,i=e.data.key.children;if(!o||""==o||!t)return[];if(j.isArray(t)){var l=[],d=[];for(n=0,a=t.length;a>n;n++)d[t[n][o]]=t[n];for(n=0,a=t.length;a>n;n++)d[t[n][r]]&&t[n][o]!=t[n][r]?(d[t[n][r]][i]||(d[t[n][r]][i]=[]),d[t[n][r]][i].push(t[n])):l.push(t[n]);return l}return[t]}},m={bindEvent:function(){for(var e=0,t=w.length;t>e;e++)w[e].apply(this,arguments)},unbindEvent:function(){for(var e=0,t=x.length;t>e;e++)x[e].apply(this,arguments)},bindTree:function(e){var t={treeId:e.treeId},e=e.treeObj;e.bind("selectstart",function(e){return e=e.originalEvent.srcElement.nodeName.toLowerCase(),"input"===e||"textarea"===e}).css({"-moz-user-select":"-moz-none"}),e.bind("click",t,m.proxy),e.bind("dblclick",t,m.proxy),e.bind("mouseover",t,m.proxy),e.bind("mouseout",t,m.proxy),e.bind("mousedown",t,m.proxy),e.bind("mouseup",t,m.proxy),e.bind("contextmenu",t,m.proxy)},unbindTree:function(e){e.treeObj.unbind("click",m.proxy).unbind("dblclick",m.proxy).unbind("mouseover",m.proxy).unbind("mouseout",m.proxy).unbind("mousedown",m.proxy).unbind("mouseup",m.proxy).unbind("contextmenu",m.proxy)},doProxy:function(){for(var e=[],t=0,n=s.length;n>t;t++){var a=s[t].apply(this,arguments);if(e.push(a),a.stop)break}return e},proxy:function(e){var t=h.getSetting(e.data.treeId);if(!j.uCanDo(t,e))return!0;for(var t=m.doProxy(e),n=!0,a=0,o=t.length;o>a;a++){var r=t[a];r.nodeEventCallback&&(n=r.nodeEventCallback.apply(r,[e,r.node])&&n),r.treeEventCallback&&(n=r.treeEventCallback.apply(r,[e,r.node])&&n)}return n}};G=function(e,t){var n=h.getSetting(e.data.treeId);if(t.open){if(0==j.apply(n.callback.beforeCollapse,[n.treeId,t],!0))return!0}else if(0==j.apply(n.callback.beforeExpand,[n.treeId,t],!0))return!0;return h.getRoot(n).expandTriggerFlag=!0,i.switchNode(n,t),!0},H=function(t,n){var a=h.getSetting(t.data.treeId),o=a.view.autoCancelSelected&&t.ctrlKey&&h.isSelectedNode(a,n)?0:a.view.autoCancelSelected&&t.ctrlKey&&a.view.selectedMulti?2:1;return 0==j.apply(a.callback.beforeClick,[a.treeId,n,o],!0)?!0:(0===o?i.cancelPreSelectedNode(a,n):i.selectNode(a,n,2===o),a.treeObj.trigger(e.event.CLICK,[t,a.treeId,n,o]),!0)},I=function(e,t){var n=h.getSetting(e.data.treeId);return j.apply(n.callback.beforeMouseDown,[n.treeId,t],!0)&&j.apply(n.callback.onMouseDown,[e,n.treeId,t]),!0},J=function(e,t){var n=h.getSetting(e.data.treeId);return j.apply(n.callback.beforeMouseUp,[n.treeId,t],!0)&&j.apply(n.callback.onMouseUp,[e,n.treeId,t]),!0},K=function(e,t){var n=h.getSetting(e.data.treeId);return j.apply(n.callback.beforeDblClick,[n.treeId,t],!0)&&j.apply(n.callback.onDblClick,[e,n.treeId,t]),!0},L=function(e,t){var n=h.getSetting(e.data.treeId);return j.apply(n.callback.beforeRightClick,[n.treeId,t],!0)&&j.apply(n.callback.onRightClick,[e,n.treeId,t]),"function"!=typeof n.callback.onRightClick};var j={apply:function(e,t,n){return"function"==typeof e?e.apply(N,t?t:[]):n},canAsync:function(e,t){var n=e.data.key.children;return e.async.enable&&t&&t.isParent&&!(t.zAsync||t[n]&&t[n].length>0)},clone:function(e){if(null===e)return null;var t,n=j.isArray(e)?[]:{};for(t in e)n[t]=e[t]instanceof Date?new Date(e[t].getTime()):"object"==typeof e[t]?arguments.callee(e[t]):e[t];return n},eqs:function(e,t){return e.toLowerCase()===t.toLowerCase()},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},$:function(e,t,n){return t&&"string"!=typeof t&&(n=t,t=""),"string"==typeof e?p(e,n?n.treeObj.get(0).ownerDocument:null):p("#"+e.tId+t,n?n.treeObj:null)},getMDom:function(e,t,n){if(!t)return null;for(;t&&t.id!==e.treeId;){for(var a=0,o=n.length;t.tagName&&o>a;a++)if(j.eqs(t.tagName,n[a].tagName)&&null!==t.getAttribute(n[a].attrName))return t;t=t.parentNode}return null},getNodeMainDom:function(e){return p(e).parent("li").get(0)||p(e).parentsUntil("li").parent().get(0)},uCanDo:function(){return!0}},i={addNodes:function(t,n,a,o){if(!t.data.keep.leaf||!n||n.isParent)if(j.isArray(a)||(a=[a]),t.data.simpleData.enable&&(a=h.transformTozTreeFormat(t,a)),n){var r=k(n,e.id.SWITCH,t),l=k(n,e.id.ICON,t),d=k(n,e.id.UL,t);n.open||(i.replaceSwitchClass(n,r,e.folder.CLOSE),i.replaceIcoClass(n,l,e.folder.CLOSE),n.open=!1,d.css({display:"none"})),h.addNodesData(t,n,a),i.createNodes(t,n.level+1,a,n),o||i.expandCollapseParentNode(t,n,!0)}else h.addNodesData(t,h.getRoot(t),a),i.createNodes(t,0,a,null)},appendNodes:function(e,t,n,a,o,r){if(!n)return[];for(var l=[],d=e.data.key.children,s=0,c=n.length;c>s;s++){var u=n[s];if(o){var p=(a?a:h.getRoot(e))[d].length==n.length&&0==s;h.initNode(e,t,u,a,p,s==n.length-1,r),h.addNodeCache(e,u)}p=[],u[d]&&u[d].length>0&&(p=i.appendNodes(e,t+1,u[d],u,o,r&&u.open)),r&&(i.makeDOMNodeMainBefore(l,e,u),i.makeDOMNodeLine(l,e,u),h.getBeforeA(e,u,l),i.makeDOMNodeNameBefore(l,e,u),h.getInnerBeforeA(e,u,l),i.makeDOMNodeIcon(l,e,u),h.getInnerAfterA(e,u,l),i.makeDOMNodeNameAfter(l,e,u),h.getAfterA(e,u,l),u.isParent&&u.open&&i.makeUlHtml(e,u,l,p.join("")),i.makeDOMNodeMainAfter(l,e,u),h.addCreatedNode(e,u))}return l},appendParentULDom:function(t,n){var a=[],o=k(n,t);!o.get(0)&&n.parentTId&&(i.appendParentULDom(t,n.getParentNode()),o=k(n,t));var r=k(n,e.id.UL,t);r.get(0)&&r.remove(),r=i.appendNodes(t,n.level+1,n[t.data.key.children],n,!1,!0),i.makeUlHtml(t,n,a,r.join("")),o.append(a.join(""))},asyncNode:function(b,a,c,d){var f,g;if(a&&!a.isParent)return j.apply(d),!1;if(a&&a.isAjaxing)return!1;if(0==j.apply(b.callback.beforeAsync,[b.treeId,a],!0))return j.apply(d),!1;a&&(a.isAjaxing=!0,k(a,e.id.ICON,b).attr({style:"","class":e.className.BUTTON+" "+e.className.ICO_LOADING}));var l={};for(f=0,g=b.async.autoParam.length;a&&g>f;f++){var q=b.async.autoParam[f].split("="),n=q;q.length>1&&(n=q[1],q=q[0]),l[n]=a[q]}if(j.isArray(b.async.otherParam))for(f=0,g=b.async.otherParam.length;g>f;f+=2)l[b.async.otherParam[f]]=b.async.otherParam[f+1];else for(var m in b.async.otherParam)l[m]=b.async.otherParam[m];var o=h.getRoot(b)._ver;return p.ajax({contentType:b.async.contentType,type:b.async.type,url:j.apply(b.async.url,[b.treeId,a],b.async.url),data:l,dataType:b.async.dataType,success:function(f){if(o==h.getRoot(b)._ver){var g=[];try{g=f&&0!=f.length?"string"==typeof f?eval("("+f+")"):f:[]}catch(l){g=f}a&&(a.isAjaxing=null,a.zAsync=!0),i.setNodeLineIcos(b,a),g&&""!==g?(g=j.apply(b.async.dataFilter,[b.treeId,a,g],g),i.addNodes(b,a,g?j.clone(g):[],!!c)):i.addNodes(b,a,[],!!c),b.treeObj.trigger(e.event.ASYNC_SUCCESS,[b.treeId,a,f]),j.apply(d)}},error:function(t,n,r){o==h.getRoot(b)._ver&&(a&&(a.isAjaxing=null),i.setNodeLineIcos(b,a),b.treeObj.trigger(e.event.ASYNC_ERROR,[b.treeId,a,t,n,r]))}}),!0},cancelPreSelectedNode:function(t,n){for(var a=h.getRoot(t).curSelectedList,o=a.length-1;o>=0;o--)if((!n||n===a[o])&&(k(a[o],e.id.A,t).removeClass(e.node.CURSELECTED),n)){h.removeSelectedNode(t,n);break}n||(h.getRoot(t).curSelectedList=[])},createNodeCallback:function(t){if(t.callback.onNodeCreated||t.view.addDiyDom)for(var n=h.getRoot(t);n.createdNodes.length>0;){var a=n.createdNodes.shift();j.apply(t.view.addDiyDom,[t.treeId,a]),t.callback.onNodeCreated&&t.treeObj.trigger(e.event.NODECREATED,[t.treeId,a])}},createNodes:function(t,n,a,o){if(a&&0!=a.length){var r=h.getRoot(t),l=t.data.key.children,l=!o||o.open||!!k(o[l][0],t).get(0);r.createdNodes=[],n=i.appendNodes(t,n,a,o,!0,l),o?(o=k(o,e.id.UL,t),o.get(0)&&o.append(n.join(""))):t.treeObj.append(n.join("")),i.createNodeCallback(t)}},destroy:function(e){e&&(h.initCache(e),h.initRoot(e),m.unbindTree(e),m.unbindEvent(e),e.treeObj.empty())},expandCollapseNode:function(t,n,a,o,r){var l=h.getRoot(t),d=t.data.key.children;if(n){if(l.expandTriggerFlag){var s=r,r=function(){s&&s(),n.open?t.treeObj.trigger(e.event.EXPAND,[t.treeId,n]):t.treeObj.trigger(e.event.COLLAPSE,[t.treeId,n])};l.expandTriggerFlag=!1}if(!n.open&&n.isParent&&(!k(n,e.id.UL,t).get(0)||n[d]&&n[d].length>0&&!k(n[d][0],t).get(0))&&(i.appendParentULDom(t,n),i.createNodeCallback(t)),n.open==a)j.apply(r,[]);else{var a=k(n,e.id.UL,t),l=k(n,e.id.SWITCH,t),c=k(n,e.id.ICON,t);n.isParent?(n.open=!n.open,n.iconOpen&&n.iconClose&&c.attr("style",i.makeNodeIcoStyle(t,n)),n.open?(i.replaceSwitchClass(n,l,e.folder.OPEN),i.replaceIcoClass(n,c,e.folder.OPEN),0==o||""==t.view.expandSpeed?(a.show(),j.apply(r,[])):n[d]&&n[d].length>0?a.slideDown(t.view.expandSpeed,r):(a.show(),j.apply(r,[]))):(i.replaceSwitchClass(n,l,e.folder.CLOSE),i.replaceIcoClass(n,c,e.folder.CLOSE),0!=o&&""!=t.view.expandSpeed&&n[d]&&n[d].length>0?a.slideUp(t.view.expandSpeed,r):(a.hide(),j.apply(r,[])))):j.apply(r,[])}}else j.apply(r,[])},expandCollapseParentNode:function(e,t,n,a,o){t&&(t.parentTId?(i.expandCollapseNode(e,t,n,a),t.parentTId&&i.expandCollapseParentNode(e,t.getParentNode(),n,a,o)):i.expandCollapseNode(e,t,n,a,o))},expandCollapseSonNode:function(e,t,n,a,o){var r=h.getRoot(e),l=e.data.key.children,r=t?t[l]:r[l],l=t?!1:a,d=h.getRoot(e).expandTriggerFlag;if(h.getRoot(e).expandTriggerFlag=!1,r)for(var s=0,c=r.length;c>s;s++)r[s]&&i.expandCollapseSonNode(e,r[s],n,l);h.getRoot(e).expandTriggerFlag=d,i.expandCollapseNode(e,t,n,a,o)},makeDOMNodeIcon:function(t,n,a){var o=h.getNodeName(n,a),o=n.view.nameIsHTML?o:o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");t.push("<span id='",a.tId,e.id.ICON,"' title='' treeNode",e.id.ICON," class='",i.makeNodeIcoClass(n,a),"' style='",i.makeNodeIcoStyle(n,a),"'></span><span id='",a.tId,e.id.SPAN,"'>",o,"</span>")},makeDOMNodeLine:function(t,n,a){t.push("<span id='",a.tId,e.id.SWITCH,"' title='' class='",i.makeNodeLineClass(n,a),"' treeNode",e.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(e){e.push("</li>")},makeDOMNodeMainBefore:function(t,n,a){t.push("<li id='",a.tId,"' class='",e.className.LEVEL,a.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(e){e.push("</a>")},makeDOMNodeNameBefore:function(t,n,a){var o,r=h.getNodeTitle(n,a),l=i.makeNodeUrl(n,a),d=i.makeNodeFontCss(n,a),s=[];for(o in d)s.push(o,":",d[o],";");t.push("<a id='",a.tId,e.id.A,"' class='",e.className.LEVEL,a.level,"' treeNode",e.id.A,' onclick="',a.click||"",'" ',null!=l&&l.length>0?"href='"+l+"'":""," target='",i.makeNodeTarget(a),"' style='",s.join(""),"'"),j.apply(n.view.showTitle,[n.treeId,a],n.view.showTitle)&&r&&t.push("title='",r.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),t.push(">")},makeNodeFontCss:function(e,t){var n=j.apply(e.view.fontCss,[e.treeId,t],e.view.fontCss);return n&&"function"!=typeof n?n:{}},makeNodeIcoClass:function(t,n){var a=["ico"];return n.isAjaxing||(a[0]=(n.iconSkin?n.iconSkin+"_":"")+a[0],a.push(n.isParent?n.open?e.folder.OPEN:e.folder.CLOSE:e.folder.DOCU)),e.className.BUTTON+" "+a.join("_")},makeNodeIcoStyle:function(e,t){var n=[];if(!t.isAjaxing){var a=t.isParent&&t.iconOpen&&t.iconClose?t.open?t.iconOpen:t.iconClose:t.icon;a&&n.push("background:url(",a,") 0 0 no-repeat;"),(0==e.view.showIcon||!j.apply(e.view.showIcon,[e.treeId,t],!0))&&n.push("width:0px;height:0px;")}return n.join("")},makeNodeLineClass:function(t,n){var a=[];return a.push(t.view.showLine?0==n.level&&n.isFirstNode&&n.isLastNode?e.line.ROOT:0==n.level&&n.isFirstNode?e.line.ROOTS:n.isLastNode?e.line.BOTTOM:e.line.CENTER:e.line.NOLINE),a.push(n.isParent?n.open?e.folder.OPEN:e.folder.CLOSE:e.folder.DOCU),i.makeNodeLineClassEx(n)+a.join("_")},makeNodeLineClassEx:function(t){return e.className.BUTTON+" "+e.className.LEVEL+t.level+" "+e.className.SWITCH+" "},makeNodeTarget:function(e){return e.target||"_blank"},makeNodeUrl:function(e,t){var n=e.data.key.url;return t[n]?t[n]:null},makeUlHtml:function(t,n,a,o){a.push("<ul id='",n.tId,e.id.UL,"' class='",e.className.LEVEL,n.level," ",i.makeUlLineClass(t,n),"' style='display:",n.open?"block":"none","'>"),a.push(o),a.push("</ul>")},makeUlLineClass:function(t,n){return t.view.showLine&&!n.isLastNode?e.line.LINE:""},removeChildNodes:function(t,n){if(n){var a=t.data.key.children,o=n[a];if(o){for(var r=0,l=o.length;l>r;r++)h.removeNodeCache(t,o[r]);h.removeSelectedNode(t),delete n[a],t.data.keep.parent?k(n,e.id.UL,t).empty():(n.isParent=!1,n.open=!1,a=k(n,e.id.SWITCH,t),o=k(n,e.id.ICON,t),i.replaceSwitchClass(n,a,e.folder.DOCU),i.replaceIcoClass(n,o,e.folder.DOCU),k(n,e.id.UL,t).remove())}}},setFirstNode:function(e,t){var n=e.data.key.children;t[n].length>0&&(t[n][0].isFirstNode=!0)},setLastNode:function(e,t){var n=e.data.key.children,a=t[n].length;a>0&&(t[n][a-1].isLastNode=!0)},removeNode:function(t,n){var a=h.getRoot(t),o=t.data.key.children,r=n.parentTId?n.getParentNode():a;if(n.isFirstNode=!1,n.isLastNode=!1,n.getPreNode=function(){return null},n.getNextNode=function(){return null},h.getNodeCache(t,n.tId)){k(n,t).remove(),h.removeNodeCache(t,n),h.removeSelectedNode(t,n);for(var l=0,d=r[o].length;d>l;l++)if(r[o][l].tId==n.tId){r[o].splice(l,1);break}i.setFirstNode(t,r),i.setLastNode(t,r);var s,l=r[o].length;if(t.data.keep.parent||0!=l){if(t.view.showLine&&l>0){var c=r[o][l-1],l=k(c,e.id.UL,t),d=k(c,e.id.SWITCH,t);s=k(c,e.id.ICON,t),r==a?1==r[o].length?i.replaceSwitchClass(c,d,e.line.ROOT):(a=k(r[o][0],e.id.SWITCH,t),i.replaceSwitchClass(r[o][0],a,e.line.ROOTS),i.replaceSwitchClass(c,d,e.line.BOTTOM)):i.replaceSwitchClass(c,d,e.line.BOTTOM),l.removeClass(e.line.LINE)}}else r.isParent=!1,r.open=!1,l=k(r,e.id.UL,t),d=k(r,e.id.SWITCH,t),s=k(r,e.id.ICON,t),i.replaceSwitchClass(r,d,e.folder.DOCU),i.replaceIcoClass(r,s,e.folder.DOCU),l.css("display","none")}},replaceIcoClass:function(t,n,a){if(n&&!t.isAjaxing&&(t=n.attr("class"),void 0!=t)){switch(t=t.split("_"),a){case e.folder.OPEN:case e.folder.CLOSE:case e.folder.DOCU:t[t.length-1]=a}n.attr("class",t.join("_"))}},replaceSwitchClass:function(t,n,a){if(n){var o=n.attr("class");if(void 0!=o){switch(o=o.split("_"),a){case e.line.ROOT:case e.line.ROOTS:case e.line.CENTER:case e.line.BOTTOM:case e.line.NOLINE:o[0]=i.makeNodeLineClassEx(t)+a;break;case e.folder.OPEN:case e.folder.CLOSE:case e.folder.DOCU:o[1]=a}n.attr("class",o.join("_")),a!==e.folder.DOCU?n.removeAttr("disabled"):n.attr("disabled","disabled")}}},selectNode:function(t,n,a){a||i.cancelPreSelectedNode(t),k(n,e.id.A,t).addClass(e.node.CURSELECTED),h.addSelectedNode(t,n)},setNodeFontCss:function(t,n){var a=k(n,e.id.A,t),o=i.makeNodeFontCss(t,n);o&&a.css(o)},setNodeLineIcos:function(t,n){if(n){var a=k(n,e.id.SWITCH,t),o=k(n,e.id.UL,t),r=k(n,e.id.ICON,t),l=i.makeUlLineClass(t,n);0==l.length?o.removeClass(e.line.LINE):o.addClass(l),a.attr("class",i.makeNodeLineClass(t,n)),n.isParent?a.removeAttr("disabled"):a.attr("disabled","disabled"),r.removeAttr("style"),r.attr("style",i.makeNodeIcoStyle(t,n)),r.attr("class",i.makeNodeIcoClass(t,n))}},setNodeName:function(t,n){var a=h.getNodeTitle(t,n),o=k(n,e.id.SPAN,t);o.empty(),t.view.nameIsHTML?o.html(h.getNodeName(t,n)):o.text(h.getNodeName(t,n)),j.apply(t.view.showTitle,[t.treeId,n],t.view.showTitle)&&k(n,e.id.A,t).attr("title",a?a:"")},setNodeTarget:function(t,n){k(n,e.id.A,t).attr("target",i.makeNodeTarget(n))},setNodeUrl:function(t,n){var a=k(n,e.id.A,t),o=i.makeNodeUrl(t,n);null==o||0==o.length?a.removeAttr("href"):a.attr("href",o)},switchNode:function(e,t){t.open||!j.canAsync(e,t)?i.expandCollapseNode(e,t,!t.open):e.async.enable?i.asyncNode(e,t)||i.expandCollapseNode(e,t,!t.open):t&&i.expandCollapseNode(e,t,!t.open)}};p.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:j,view:i,event:m,data:h},getZTreeObj:function(e){return(e=h.getZTreeTools(e))?e:null},destroy:function(e){if(e&&e.length>0)i.destroy(h.getSetting(e));else for(var t in r)i.destroy(r[t])},init:function(t,n,a){var o=j.clone(M);return p.extend(!0,o,n),o.treeId=t.attr("id"),o.treeObj=t,o.treeObj.empty(),r[o.treeId]=o,"undefined"==typeof document.body.style.maxHeight&&(o.view.expandSpeed=""),h.initRoot(o),t=h.getRoot(o),n=o.data.key.children,a=a?j.clone(j.isArray(a)?a:[a]):[],t[n]=o.data.simpleData.enable?h.transformTozTreeFormat(o,a):a,h.initCache(o),m.unbindTree(o),m.bindTree(o),m.unbindEvent(o),m.bindEvent(o),a={setting:o,addNodes:function(e,t,n){function a(){i.addNodes(o,e,r,1==n)}if(!t)return null;if(e||(e=null),e&&!e.isParent&&o.data.keep.leaf)return null;var r=j.clone(j.isArray(t)?t:[t]);return j.canAsync(o,e)?i.asyncNode(o,e,n,a):a(),r},cancelSelectedNode:function(e){i.cancelPreSelectedNode(o,e)},destroy:function(){i.destroy(o)},expandAll:function(e){return e=!!e,i.expandCollapseSonNode(o,null,e,!0),e},expandNode:function(e,t,n,a,r){if(!e||!e.isParent)return null;if(t!==!0&&t!==!1&&(t=!e.open),(r=!!r)&&t&&0==j.apply(o.callback.beforeExpand,[o.treeId,e],!0))return null;if(r&&!t&&0==j.apply(o.callback.beforeCollapse,[o.treeId,e],!0))return null;if(t&&e.parentTId&&i.expandCollapseParentNode(o,e.getParentNode(),t,!1),t===e.open&&!n)return null;if(h.getRoot(o).expandTriggerFlag=r,!j.canAsync(o,e)&&n)i.expandCollapseSonNode(o,e,t,!0,function(){if(a!==!1)try{k(e,o).focus().blur()}catch(t){}});else if(e.open=!t,i.switchNode(this.setting,e),a!==!1)try{k(e,o).focus().blur()}catch(l){}return t},getNodes:function(){return h.getNodes(o)},getNodeByParam:function(e,t,n){return e?h.getNodeByParam(o,n?n[o.data.key.children]:h.getNodes(o),e,t):null},getNodeByTId:function(e){return h.getNodeCache(o,e)},getNodesByParam:function(e,t,n){return e?h.getNodesByParam(o,n?n[o.data.key.children]:h.getNodes(o),e,t):null},getNodesByParamFuzzy:function(e,t,n){return e?h.getNodesByParamFuzzy(o,n?n[o.data.key.children]:h.getNodes(o),e,t):null},getNodesByFilter:function(e,t,n,a){return t=!!t,e&&"function"==typeof e?h.getNodesByFilter(o,n?n[o.data.key.children]:h.getNodes(o),e,t,a):t?null:[]},getNodeIndex:function(e){if(!e)return null;for(var t=o.data.key.children,n=e.parentTId?e.getParentNode():h.getRoot(o),a=0,r=n[t].length;r>a;a++)if(n[t][a]==e)return a;return-1},getSelectedNodes:function(){for(var e=[],t=h.getRoot(o).curSelectedList,n=0,a=t.length;a>n;n++)e.push(t[n]);return e},isSelectedNode:function(e){return h.isSelectedNode(o,e)},reAsyncChildNodes:function(t,n,a){if(this.setting.async.enable){var r=!t;if(r&&(t=h.getRoot(o)),"refresh"==n){for(var n=this.setting.data.key.children,l=0,d=t[n]?t[n].length:0;d>l;l++)h.removeNodeCache(o,t[n][l]);h.removeSelectedNode(o),t[n]=[],r?this.setting.treeObj.empty():k(t,e.id.UL,o).empty()}i.asyncNode(this.setting,r?null:t,!!a)}},refresh:function(){this.setting.treeObj.empty();var e=h.getRoot(o),t=e[o.data.key.children];h.initRoot(o),e[o.data.key.children]=t,h.initCache(o),i.createNodes(o,0,e[o.data.key.children])},removeChildNodes:function(e){if(!e)return null;var t=e[o.data.key.children];return i.removeChildNodes(o,e),t?t:null},removeNode:function(t,n){t&&(n=!!n,n&&0==j.apply(o.callback.beforeRemove,[o.treeId,t],!0)||(i.removeNode(o,t),n&&this.setting.treeObj.trigger(e.event.REMOVE,[o.treeId,t])))},selectNode:function(e,t){if(e&&j.uCanDo(o)){if(t=o.view.selectedMulti&&t,e.parentTId)i.expandCollapseParentNode(o,e.getParentNode(),!0,!1,function(){try{k(e,o).focus().blur()}catch(t){}});else try{k(e,o).focus().blur()}catch(n){}i.selectNode(o,e,t)}},transformTozTreeNodes:function(e){return h.transformTozTreeFormat(o,e)},transformToArray:function(e){return h.transformToArrayFormat(o,e)},updateNode:function(e){e&&k(e,o).get(0)&&j.uCanDo(o)&&(i.setNodeName(o,e),i.setNodeTarget(o,e),i.setNodeUrl(o,e),i.setNodeLineIcos(o,e),i.setNodeFontCss(o,e))}},t.treeTools=a,h.setZTreeTools(o,a),t[n]&&t[n].length>0?i.createNodes(o,0,t[n]):o.async.enable&&o.async.url&&""!==o.async.url&&i.asyncNode(o),a}};var N=p.fn.zTree,k=j.$,e=N.consts}(jQuery);