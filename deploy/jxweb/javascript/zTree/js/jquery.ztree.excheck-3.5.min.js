!function(e){var c,t,a,h={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},k={check:{enable:!1,autoCheckTrigger:!1,chkStyle:h.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:h.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};c=function(e,c){if(c.chkDisabled===!0)return!1;var t=i.getSetting(e.data.treeId),a=t.data.key.checked;return 0==n.apply(t.callback.beforeCheck,[t.treeId,c],!0)?!0:(c[a]=!c[a],d.checkNodeRelation(t,c),a=o(c,r.id.CHECK,t),d.setChkClass(t,a,c),d.repairParentChkClassWithSelf(t,c),t.treeObj.trigger(r.event.CHECK,[e,t.treeId,c]),!0)},t=function(e,c){if(c.chkDisabled===!0)return!1;var t=i.getSetting(e.data.treeId),a=o(c,r.id.CHECK,t);return c.check_Focus=!0,d.setChkClass(t,a,c),!0},a=function(e,c){if(c.chkDisabled===!0)return!1;var t=i.getSetting(e.data.treeId),a=o(c,r.id.CHECK,t);return c.check_Focus=!1,d.setChkClass(t,a,c),!0},e.extend(!0,e.fn.zTree.consts,h),e.extend(!0,e.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(e,c){var t,a,h,k=e.data.key.children,n=e.data.key.checked;if(t=r.radio,e.check.chkStyle==t.STYLE){var l=i.getRadioCheckedList(e);if(c[n])if(e.check.radioType==t.TYPE_ALL){for(a=l.length-1;a>=0;a--)t=l[a],t[n]=!1,l.splice(a,1),d.setChkClass(e,o(t,r.id.CHECK,e),t),t.parentTId!=c.parentTId&&d.repairParentChkClassWithSelf(e,t);l.push(c)}else for(l=c.parentTId?c.getParentNode():i.getRoot(e),a=0,h=l[k].length;h>a;a++)t=l[k][a],t[n]&&t!=c&&(t[n]=!1,d.setChkClass(e,o(t,r.id.CHECK,e),t));else if(e.check.radioType==t.TYPE_ALL)for(a=0,h=l.length;h>a;a++)if(c==l[a]){l.splice(a,1);break}}else c[n]&&(!c[k]||0==c[k].length||e.check.chkboxType.Y.indexOf("s")>-1)&&d.setSonNodeCheckBox(e,c,!0),!c[n]&&(!c[k]||0==c[k].length||e.check.chkboxType.N.indexOf("s")>-1)&&d.setSonNodeCheckBox(e,c,!1),c[n]&&e.check.chkboxType.Y.indexOf("p")>-1&&d.setParentNodeCheckBox(e,c,!0),!c[n]&&e.check.chkboxType.N.indexOf("p")>-1&&d.setParentNodeCheckBox(e,c,!1)},makeChkClass:function(e,c){var t=e.data.key.checked,a=r.checkbox,h=r.radio,k="",k=c.chkDisabled===!0?a.DISABLED:c.halfCheck?a.PART:e.check.chkStyle==h.STYLE?c.check_Child_State<1?a.FULL:a.PART:c[t]?2===c.check_Child_State||-1===c.check_Child_State?a.FULL:a.PART:c.check_Child_State<1?a.FULL:a.PART,t=e.check.chkStyle+"_"+(c[t]?a.TRUE:a.FALSE)+"_"+k,t=c.check_Focus&&c.chkDisabled!==!0?t+"_"+a.FOCUS:t;return r.className.BUTTON+" "+a.DEFAULT+" "+t},repairAllChk:function(e,c){if(e.check.enable&&e.check.chkStyle===r.checkbox.STYLE)for(var t=e.data.key.checked,a=e.data.key.children,h=i.getRoot(e),k=0,n=h[a].length;n>k;k++){var o=h[a][k];o.nocheck!==!0&&o.chkDisabled!==!0&&(o[t]=c),d.setSonNodeCheckBox(e,o,c)}},repairChkClass:function(e,c){if(c&&(i.makeChkFlag(e,c),c.nocheck!==!0)){var t=o(c,r.id.CHECK,e);d.setChkClass(e,t,c)}},repairParentChkClass:function(e,c){if(c&&c.parentTId){var t=c.getParentNode();d.repairChkClass(e,t),d.repairParentChkClass(e,t)}},repairParentChkClassWithSelf:function(e,c){if(c){var t=e.data.key.children;c[t]&&c[t].length>0?d.repairParentChkClass(e,c[t][0]):d.repairParentChkClass(e,c)}},repairSonChkDisabled:function(e,c,t,a){if(c){var h=e.data.key.children;if(c.chkDisabled!=t&&(c.chkDisabled=t),d.repairChkClass(e,c),c[h]&&a)for(var k=0,n=c[h].length;n>k;k++)d.repairSonChkDisabled(e,c[h][k],t,a)}},repairParentChkDisabled:function(e,c,t,a){c&&(c.chkDisabled!=t&&a&&(c.chkDisabled=t),d.repairChkClass(e,c),d.repairParentChkDisabled(e,c.getParentNode(),t,a))},setChkClass:function(e,c,t){c&&(t.nocheck===!0?c.hide():c.show(),c.removeClass(),c.addClass(d.makeChkClass(e,t)))},setParentNodeCheckBox:function(e,c,t,a){var h=e.data.key.children,k=e.data.key.checked,n=o(c,r.id.CHECK,e);if(a||(a=c),i.makeChkFlag(e,c),c.nocheck!==!0&&c.chkDisabled!==!0&&(c[k]=t,d.setChkClass(e,n,c),e.check.autoCheckTrigger&&c!=a&&e.treeObj.trigger(r.event.CHECK,[null,e.treeId,c])),c.parentTId){if(n=!0,!t)for(var h=c.getParentNode()[h],l=0,s=h.length;s>l;l++)if(h[l].nocheck!==!0&&h[l].chkDisabled!==!0&&h[l][k]||(h[l].nocheck===!0||h[l].chkDisabled===!0)&&h[l].check_Child_State>0){n=!1;break}n&&d.setParentNodeCheckBox(e,c.getParentNode(),t,a)}},setSonNodeCheckBox:function(e,c,t,a){if(c){var h=e.data.key.children,k=e.data.key.checked,n=o(c,r.id.CHECK,e);a||(a=c);var l=!1;if(c[h])for(var s=0,C=c[h].length;C>s&&c.chkDisabled!==!0;s++){var f=c[h][s];d.setSonNodeCheckBox(e,f,t,a),f.chkDisabled===!0&&(l=!0)}c!=i.getRoot(e)&&c.chkDisabled!==!0&&(l&&c.nocheck!==!0&&i.makeChkFlag(e,c),c.nocheck!==!0&&c.chkDisabled!==!0?(c[k]=t,l||(c.check_Child_State=c[h]&&c[h].length>0?t?2:0:-1)):c.check_Child_State=-1,d.setChkClass(e,n,c),e.check.autoCheckTrigger&&c!=a&&c.nocheck!==!0&&c.chkDisabled!==!0&&e.treeObj.trigger(r.event.CHECK,[null,e.treeId,c]))}}},event:{},data:{getRadioCheckedList:function(e){for(var c=i.getRoot(e).radioCheckedList,t=0,a=c.length;a>t;t++)i.getNodeCache(e,c[t].tId)||(c.splice(t,1),t--,a--);return c},getCheckStatus:function(e,c){if(!e.check.enable||c.nocheck||c.chkDisabled)return null;var t=e.data.key.checked;return{checked:c[t],half:c.halfCheck?c.halfCheck:e.check.chkStyle==r.radio.STYLE?2===c.check_Child_State:c[t]?c.check_Child_State>-1&&c.check_Child_State<2:c.check_Child_State>0}},getTreeCheckedNodes:function(e,c,t,a){if(!c)return[];for(var h=e.data.key.children,k=e.data.key.checked,n=t&&e.check.chkStyle==r.radio.STYLE&&e.check.radioType==r.radio.TYPE_ALL,a=a?a:[],d=0,o=c.length;o>d&&(c[d].nocheck===!0||c[d].chkDisabled===!0||c[d][k]!=t||(a.push(c[d]),!n))&&(i.getTreeCheckedNodes(e,c[d][h],t,a),!(n&&a.length>0));d++);return a},getTreeChangeCheckedNodes:function(e,c,t){if(!c)return[];for(var a=e.data.key.children,h=e.data.key.checked,t=t?t:[],k=0,n=c.length;n>k;k++)c[k].nocheck!==!0&&c[k].chkDisabled!==!0&&c[k][h]!=c[k].checkedOld&&t.push(c[k]),i.getTreeChangeCheckedNodes(e,c[k][a],t);return t},makeChkFlag:function(e,c){if(c){var t=e.data.key.children,a=e.data.key.checked,h=-1;if(c[t])for(var k=0,n=c[t].length;n>k;k++){var d=c[t][k],i=-1;if(e.check.chkStyle==r.radio.STYLE){if(i=d.nocheck===!0||d.chkDisabled===!0?d.check_Child_State:d.halfCheck===!0?2:d[a]?2:d.check_Child_State>0?2:0,2==i){h=2;break}0==i&&(h=0)}else if(e.check.chkStyle==r.checkbox.STYLE){if(i=d.nocheck===!0||d.chkDisabled===!0?d.check_Child_State:d.halfCheck===!0?1:d[a]?-1===d.check_Child_State||2===d.check_Child_State?2:1:d.check_Child_State>0?1:0,1===i){h=1;break}if(2===i&&h>-1&&k>0&&i!==h){h=1;break}if(2===h&&i>-1&&2>i){h=1;break}i>-1&&(h=i)}}c.check_Child_State=h}}}});var e=e.fn.zTree,n=e._z.tools,r=e.consts,d=e._z.view,i=e._z.data,o=n.$;i.exSetting(k),i.addInitBind(function(e){e.treeObj.bind(r.event.CHECK,function(c,t,a,h){n.apply(e.callback.onCheck,[t?t:c,a,h])})}),i.addInitUnBind(function(e){e.treeObj.unbind(r.event.CHECK)}),i.addInitCache(function(){}),i.addInitNode(function(e,c,t,a){t&&(c=e.data.key.checked,"string"==typeof t[c]&&(t[c]=n.eqs(t[c],"true")),t[c]=!!t[c],t.checkedOld=t[c],"string"==typeof t.nocheck&&(t.nocheck=n.eqs(t.nocheck,"true")),t.nocheck=!!t.nocheck||e.check.nocheckInherit&&a&&!!a.nocheck,"string"==typeof t.chkDisabled&&(t.chkDisabled=n.eqs(t.chkDisabled,"true")),t.chkDisabled=!!t.chkDisabled||e.check.chkDisabledInherit&&a&&!!a.chkDisabled,"string"==typeof t.halfCheck&&(t.halfCheck=n.eqs(t.halfCheck,"true")),t.halfCheck=!!t.halfCheck,t.check_Child_State=-1,t.check_Focus=!1,t.getCheckStatus=function(){return i.getCheckStatus(e,t)},e.check.chkStyle==r.radio.STYLE&&e.check.radioType==r.radio.TYPE_ALL&&t[c]&&i.getRoot(e).radioCheckedList.push(t))}),i.addInitProxy(function(e){var h=e.target,k=i.getSetting(e.data.treeId),d="",o=null,l="",s=null;if(n.eqs(e.type,"mouseover")?k.check.enable&&n.eqs(h.tagName,"span")&&null!==h.getAttribute("treeNode"+r.id.CHECK)&&(d=n.getNodeMainDom(h).id,l="mouseoverCheck"):n.eqs(e.type,"mouseout")?k.check.enable&&n.eqs(h.tagName,"span")&&null!==h.getAttribute("treeNode"+r.id.CHECK)&&(d=n.getNodeMainDom(h).id,l="mouseoutCheck"):n.eqs(e.type,"click")&&k.check.enable&&n.eqs(h.tagName,"span")&&null!==h.getAttribute("treeNode"+r.id.CHECK)&&(d=n.getNodeMainDom(h).id,l="checkNode"),d.length>0)switch(o=i.getNodeCache(k,d),l){case"checkNode":s=c;break;case"mouseoverCheck":s=t;break;case"mouseoutCheck":s=a}return{stop:"checkNode"===l,node:o,nodeEventType:l,nodeEventCallback:s,treeEventType:"",treeEventCallback:null}},!0),i.addInitRoot(function(e){i.getRoot(e).radioCheckedList=[]}),i.addBeforeA(function(e,c,t){e.check.enable&&(i.makeChkFlag(e,c),t.push("<span ID='",c.tId,r.id.CHECK,"' class='",d.makeChkClass(e,c),"' treeNode",r.id.CHECK,c.nocheck===!0?" style='display:none;'":"","></span>"))}),i.addZTreeTools(function(e,c){c.checkNode=function(c,t,a,h){var k=e.data.key.checked;c.chkDisabled===!0||(t!==!0&&t!==!1&&(t=!c[k]),h=!!h,c[k]===t&&!a||h&&0==n.apply(this.setting.callback.beforeCheck,[e.treeId,c],!0)||!n.uCanDo(this.setting)||!e.check.enable||c.nocheck===!0)||(c[k]=t,t=o(c,r.id.CHECK,e),(a||e.check.chkStyle===r.radio.STYLE)&&d.checkNodeRelation(e,c),d.setChkClass(e,t,c),d.repairParentChkClassWithSelf(e,c),h&&e.treeObj.trigger(r.event.CHECK,[null,e.treeId,c]))},c.checkAllNodes=function(c){d.repairAllChk(e,!!c)},c.getCheckedNodes=function(c){var t=e.data.key.children;return i.getTreeCheckedNodes(e,i.getRoot(e)[t],c!==!1)},c.getChangeCheckedNodes=function(){var c=e.data.key.children;return i.getTreeChangeCheckedNodes(e,i.getRoot(e)[c])},c.setChkDisabled=function(c,t,a,h){t=!!t,a=!!a,d.repairSonChkDisabled(e,c,t,!!h),d.repairParentChkDisabled(e,c.getParentNode(),t,a)};var t=c.updateNode;c.updateNode=function(a,h){if(t&&t.apply(c,arguments),a&&e.check.enable&&o(a,e).get(0)&&n.uCanDo(e)){var k=o(a,r.id.CHECK,e);(1==h||e.check.chkStyle===r.radio.STYLE)&&d.checkNodeRelation(e,a),d.setChkClass(e,k,a),d.repairParentChkClassWithSelf(e,a)}}});var l=d.createNodes;d.createNodes=function(e,c,t,a){l&&l.apply(d,arguments),t&&d.repairParentChkClassWithSelf(e,a)};var s=d.removeNode;d.removeNode=function(e,c){var t=c.getParentNode();s&&s.apply(d,arguments),c&&t&&(d.repairChkClass(e,t),d.repairParentChkClass(e,t))};var C=d.appendNodes;d.appendNodes=function(e,c,t,a){var h="";return C&&(h=C.apply(d,arguments)),a&&i.makeChkFlag(e,a),h}}(jQuery);